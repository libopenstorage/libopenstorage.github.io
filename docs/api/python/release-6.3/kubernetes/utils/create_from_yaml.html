<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.7.4" />
<title>kubernetes.utils.create_from_yaml API documentation</title>
<meta name="description" content="" />
<link href='https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.0/normalize.min.css' rel='stylesheet'>
<link href='https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/8.0.0/sanitize.min.css' rel='stylesheet'>
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" rel="stylesheet">
<style>.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{font-weight:bold}#index h4 + ul{margin-bottom:.6em}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>kubernetes.utils.create_from_yaml</code></h1>
</header>
<section id="section-intro">
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python"># Copyright 2018 The Kubernetes Authors.
#
# Licensed under the Apache License, Version 2.0 (the &#34;License&#34;);
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an &#34;AS IS&#34; BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.


import re
from os import path

import yaml

from kubernetes import client


def create_from_yaml(
        k8s_client,
        yaml_file,
        verbose=False,
        namespace=&#34;default&#34;,
        **kwargs):
    &#34;&#34;&#34;
    Perform an action from a yaml file. Pass True for verbose to
    print confirmation information.
    Input:
    yaml_file: string. Contains the path to yaml file.
    k8s_client: an ApiClient object, initialized with the client args.
    verbose: If True, print confirmation from the create action.
        Default is False.
    namespace: string. Contains the namespace to create all
        resources inside. The namespace must preexist otherwise
        the resource creation will fail. If the API object in
        the yaml file already contains a namespace definition
        this parameter has no effect.

    Returns:
    An k8s api object or list of apis objects created from YAML.
    When a single object is generated, return type is dependent
    on output_list.

    Throws a FailToCreateError exception if creation of any object
    fails with helpful messages from the server.

    Available parameters for creating &lt;kind&gt;:
    :param async_req bool
    :param bool include_uninitialized: If true, partially initialized
        resources are included in the response.
    :param str pretty: If &#39;true&#39;, then the output is pretty printed.
    :param str dry_run: When present, indicates that modifications
        should not be persisted. An invalid or unrecognized dryRun
        directive will result in an error response and no further
        processing of the request.
        Valid values are: - All: all dry run stages will be processed
    &#34;&#34;&#34;

    with open(path.abspath(yaml_file)) as f:
        yml_document_all = yaml.safe_load_all(f)
        api_exceptions = []
        # Load all documents from a single YAML file
        for yml_document in yml_document_all:
            # If it is a list type, will need to iterate its items
            if &#34;List&#34; in yml_document[&#34;kind&#34;]:
                # Could be &#34;List&#34; or &#34;Pod/Service/...List&#34;
                # This is a list type. iterate within its items
                kind = yml_document[&#34;kind&#34;].replace(&#34;List&#34;, &#34;&#34;)
                for yml_object in yml_document[&#34;items&#34;]:
                    # Mitigate cases when server returns a xxxList object
                    # See kubernetes-client/python#586
                    if kind is not &#34;&#34;:
                        yml_object[&#34;apiVersion&#34;] = yml_document[&#34;apiVersion&#34;]
                        yml_object[&#34;kind&#34;] = kind
                    try:
                        create_from_yaml_single_item(
                            k8s_client, yml_object, verbose, namespace, **kwargs)
                    except client.rest.ApiException as api_exception:
                        api_exceptions.append(api_exception)
            else:
                # This is a single object. Call the single item method
                try:
                    create_from_yaml_single_item(
                        k8s_client, yml_document, verbose, namespace, **kwargs)
                except client.rest.ApiException as api_exception:
                    api_exceptions.append(api_exception)
    # In case we have exceptions waiting for us, raise them
    if api_exceptions:
        raise FailToCreateError(api_exceptions)


def create_from_yaml_single_item(
        k8s_client,
        yml_object,
        verbose=False,
        namespace=&#34;default&#34;,
        **kwargs):
    group, _, version = yml_object[&#34;apiVersion&#34;].partition(&#34;/&#34;)
    if version == &#34;&#34;:
        version = group
        group = &#34;core&#34;
    # Take care for the case e.g. api_type is &#34;apiextensions.k8s.io&#34;
    # Only replace the last instance
    group = &#34;&#34;.join(group.rsplit(&#34;.k8s.io&#34;, 1))
    # convert group name from DNS subdomain format to
    # python class name convention
    group = &#34;&#34;.join(word.capitalize() for word in group.split(&#39;.&#39;))
    fcn_to_call = &#34;{0}{1}Api&#34;.format(group, version.capitalize())
    k8s_api = getattr(client, fcn_to_call)(k8s_client)
    # Replace CamelCased action_type into snake_case
    kind = yml_object[&#34;kind&#34;]
    kind = re.sub(&#39;(.)([A-Z][a-z]+)&#39;, r&#39;\1_\2&#39;, kind)
    kind = re.sub(&#39;([a-z0-9])([A-Z])&#39;, r&#39;\1_\2&#39;, kind).lower()
    # Decide which namespace we are going to put the object in,
    # if any
    if &#34;namespace&#34; in yml_object[&#34;metadata&#34;]:
        namespace = yml_object[&#34;metadata&#34;][&#34;namespace&#34;]
    # Expect the user to create namespaced objects more often
    if hasattr(k8s_api, &#34;create_namespaced_{0}&#34;.format(kind)):
        resp = getattr(k8s_api, &#34;create_namespaced_{0}&#34;.format(kind))(
            body=yml_object, namespace=namespace, **kwargs)
    else:
        resp = getattr(k8s_api, &#34;create_{0}&#34;.format(kind))(
            body=yml_object, **kwargs)
    if verbose:
        print(&#34;{0} created. status=&#39;{1}&#39;&#34;.format(kind, str(resp.status)))


class FailToCreateError(Exception):
    &#34;&#34;&#34;
    An exception class for handling error if an error occurred when
    handling a yaml file.
    &#34;&#34;&#34;

    def __init__(self, api_exceptions):
        self.api_exceptions = api_exceptions

    def __str__(self):
        msg = &#34;&#34;
        for api_exception in self.api_exceptions:
            msg += &#34;Error from server ({0}): {1}&#34;.format(
                api_exception.reason, api_exception.body)
        return msg</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="kubernetes.utils.create_from_yaml.create_from_yaml"><code class="name flex">
<span>def <span class="ident">create_from_yaml</span></span>(<span>k8s_client, yaml_file, verbose=False, namespace='default', **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Perform an action from a yaml file. Pass True for verbose to
print confirmation information.
Input:
yaml_file: string. Contains the path to yaml file.
k8s_client: an ApiClient object, initialized with the client args.
verbose: If True, print confirmation from the create action.
Default is False.
namespace: string. Contains the namespace to create all
resources inside. The namespace must preexist otherwise
the resource creation will fail. If the API object in
the yaml file already contains a namespace definition
this parameter has no effect.</p>
<p>Returns:
An k8s api object or list of apis objects created from YAML.
When a single object is generated, return type is dependent
on output_list.</p>
<p>Throws a FailToCreateError exception if creation of any object
fails with helpful messages from the server.</p>
<p>Available parameters for creating <kind>:
:param async_req bool
:param bool include_uninitialized: If true, partially initialized
resources are included in the response.
:param str pretty: If 'true', then the output is pretty printed.
:param str dry_run: When present, indicates that modifications
should not be persisted. An invalid or unrecognized dryRun
directive will result in an error response and no further
processing of the request.
Valid values are: - All: all dry run stages will be processed</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def create_from_yaml(
        k8s_client,
        yaml_file,
        verbose=False,
        namespace=&#34;default&#34;,
        **kwargs):
    &#34;&#34;&#34;
    Perform an action from a yaml file. Pass True for verbose to
    print confirmation information.
    Input:
    yaml_file: string. Contains the path to yaml file.
    k8s_client: an ApiClient object, initialized with the client args.
    verbose: If True, print confirmation from the create action.
        Default is False.
    namespace: string. Contains the namespace to create all
        resources inside. The namespace must preexist otherwise
        the resource creation will fail. If the API object in
        the yaml file already contains a namespace definition
        this parameter has no effect.

    Returns:
    An k8s api object or list of apis objects created from YAML.
    When a single object is generated, return type is dependent
    on output_list.

    Throws a FailToCreateError exception if creation of any object
    fails with helpful messages from the server.

    Available parameters for creating &lt;kind&gt;:
    :param async_req bool
    :param bool include_uninitialized: If true, partially initialized
        resources are included in the response.
    :param str pretty: If &#39;true&#39;, then the output is pretty printed.
    :param str dry_run: When present, indicates that modifications
        should not be persisted. An invalid or unrecognized dryRun
        directive will result in an error response and no further
        processing of the request.
        Valid values are: - All: all dry run stages will be processed
    &#34;&#34;&#34;

    with open(path.abspath(yaml_file)) as f:
        yml_document_all = yaml.safe_load_all(f)
        api_exceptions = []
        # Load all documents from a single YAML file
        for yml_document in yml_document_all:
            # If it is a list type, will need to iterate its items
            if &#34;List&#34; in yml_document[&#34;kind&#34;]:
                # Could be &#34;List&#34; or &#34;Pod/Service/...List&#34;
                # This is a list type. iterate within its items
                kind = yml_document[&#34;kind&#34;].replace(&#34;List&#34;, &#34;&#34;)
                for yml_object in yml_document[&#34;items&#34;]:
                    # Mitigate cases when server returns a xxxList object
                    # See kubernetes-client/python#586
                    if kind is not &#34;&#34;:
                        yml_object[&#34;apiVersion&#34;] = yml_document[&#34;apiVersion&#34;]
                        yml_object[&#34;kind&#34;] = kind
                    try:
                        create_from_yaml_single_item(
                            k8s_client, yml_object, verbose, namespace, **kwargs)
                    except client.rest.ApiException as api_exception:
                        api_exceptions.append(api_exception)
            else:
                # This is a single object. Call the single item method
                try:
                    create_from_yaml_single_item(
                        k8s_client, yml_document, verbose, namespace, **kwargs)
                except client.rest.ApiException as api_exception:
                    api_exceptions.append(api_exception)
    # In case we have exceptions waiting for us, raise them
    if api_exceptions:
        raise FailToCreateError(api_exceptions)</code></pre>
</details>
</dd>
<dt id="kubernetes.utils.create_from_yaml.create_from_yaml_single_item"><code class="name flex">
<span>def <span class="ident">create_from_yaml_single_item</span></span>(<span>k8s_client, yml_object, verbose=False, namespace='default', **kwargs)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def create_from_yaml_single_item(
        k8s_client,
        yml_object,
        verbose=False,
        namespace=&#34;default&#34;,
        **kwargs):
    group, _, version = yml_object[&#34;apiVersion&#34;].partition(&#34;/&#34;)
    if version == &#34;&#34;:
        version = group
        group = &#34;core&#34;
    # Take care for the case e.g. api_type is &#34;apiextensions.k8s.io&#34;
    # Only replace the last instance
    group = &#34;&#34;.join(group.rsplit(&#34;.k8s.io&#34;, 1))
    # convert group name from DNS subdomain format to
    # python class name convention
    group = &#34;&#34;.join(word.capitalize() for word in group.split(&#39;.&#39;))
    fcn_to_call = &#34;{0}{1}Api&#34;.format(group, version.capitalize())
    k8s_api = getattr(client, fcn_to_call)(k8s_client)
    # Replace CamelCased action_type into snake_case
    kind = yml_object[&#34;kind&#34;]
    kind = re.sub(&#39;(.)([A-Z][a-z]+)&#39;, r&#39;\1_\2&#39;, kind)
    kind = re.sub(&#39;([a-z0-9])([A-Z])&#39;, r&#39;\1_\2&#39;, kind).lower()
    # Decide which namespace we are going to put the object in,
    # if any
    if &#34;namespace&#34; in yml_object[&#34;metadata&#34;]:
        namespace = yml_object[&#34;metadata&#34;][&#34;namespace&#34;]
    # Expect the user to create namespaced objects more often
    if hasattr(k8s_api, &#34;create_namespaced_{0}&#34;.format(kind)):
        resp = getattr(k8s_api, &#34;create_namespaced_{0}&#34;.format(kind))(
            body=yml_object, namespace=namespace, **kwargs)
    else:
        resp = getattr(k8s_api, &#34;create_{0}&#34;.format(kind))(
            body=yml_object, **kwargs)
    if verbose:
        print(&#34;{0} created. status=&#39;{1}&#39;&#34;.format(kind, str(resp.status)))</code></pre>
</details>
</dd>
</dl>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="kubernetes.utils.create_from_yaml.FailToCreateError"><code class="flex name class">
<span>class <span class="ident">FailToCreateError</span></span>
<span>(</span><span>api_exceptions)</span>
</code></dt>
<dd>
<section class="desc"><p>An exception class for handling error if an error occurred when
handling a yaml file.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class FailToCreateError(Exception):
    &#34;&#34;&#34;
    An exception class for handling error if an error occurred when
    handling a yaml file.
    &#34;&#34;&#34;

    def __init__(self, api_exceptions):
        self.api_exceptions = api_exceptions

    def __str__(self):
        msg = &#34;&#34;
        for api_exception in self.api_exceptions:
            msg += &#34;Error from server ({0}): {1}&#34;.format(
                api_exception.reason, api_exception.body)
        return msg</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li>builtins.Exception</li>
<li>builtins.BaseException</li>
</ul>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="kubernetes.utils" href="index.html">kubernetes.utils</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="kubernetes.utils.create_from_yaml.create_from_yaml" href="#kubernetes.utils.create_from_yaml.create_from_yaml">create_from_yaml</a></code></li>
<li><code><a title="kubernetes.utils.create_from_yaml.create_from_yaml_single_item" href="#kubernetes.utils.create_from_yaml.create_from_yaml_single_item">create_from_yaml_single_item</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="kubernetes.utils.create_from_yaml.FailToCreateError" href="#kubernetes.utils.create_from_yaml.FailToCreateError">FailToCreateError</a></code></h4>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.7.4</a>.</p>
</footer>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad()</script>
</body>
</html>