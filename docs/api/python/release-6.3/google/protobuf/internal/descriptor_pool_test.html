<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.7.4" />
<title>google.protobuf.internal.descriptor_pool_test API documentation</title>
<meta name="description" content="Tests for google.protobuf.descriptor_pool." />
<link href='https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.0/normalize.min.css' rel='stylesheet'>
<link href='https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/8.0.0/sanitize.min.css' rel='stylesheet'>
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" rel="stylesheet">
<style>.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{font-weight:bold}#index h4 + ul{margin-bottom:.6em}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>google.protobuf.internal.descriptor_pool_test</code></h1>
</header>
<section id="section-intro">
<p>Tests for google.protobuf.descriptor_pool.</p>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">#! /usr/bin/env python
#
# Protocol Buffers - Google&#39;s data interchange format
# Copyright 2008 Google Inc.  All rights reserved.
# https://developers.google.com/protocol-buffers/
#
# Redistribution and use in source and binary forms, with or without
# modification, are permitted provided that the following conditions are
# met:
#
#     * Redistributions of source code must retain the above copyright
# notice, this list of conditions and the following disclaimer.
#     * Redistributions in binary form must reproduce the above
# copyright notice, this list of conditions and the following disclaimer
# in the documentation and/or other materials provided with the
# distribution.
#     * Neither the name of Google Inc. nor the names of its
# contributors may be used to endorse or promote products derived from
# this software without specific prior written permission.
#
# THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
# &#34;AS IS&#34; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
# LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
# A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
# OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
# SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
# LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
# DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
# THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
# (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
# OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

&#34;&#34;&#34;Tests for google.protobuf.descriptor_pool.&#34;&#34;&#34;

__author__ = &#39;matthewtoia@google.com (Matt Toia)&#39;

import copy
import os

try:
  import unittest2 as unittest  #PY26
except ImportError:
  import unittest

from google.protobuf import unittest_import_pb2
from google.protobuf import unittest_import_public_pb2
from google.protobuf import unittest_pb2
from google.protobuf import descriptor_pb2
from google.protobuf.internal import api_implementation
from google.protobuf.internal import descriptor_pool_test1_pb2
from google.protobuf.internal import descriptor_pool_test2_pb2
from google.protobuf.internal import factory_test1_pb2
from google.protobuf.internal import factory_test2_pb2
from google.protobuf.internal import file_options_test_pb2
from google.protobuf.internal import more_messages_pb2
from google.protobuf.internal import no_package_pb2
from google.protobuf.internal import testing_refleaks
from google.protobuf import descriptor
from google.protobuf import descriptor_database
from google.protobuf import descriptor_pool
from google.protobuf import message_factory
from google.protobuf import symbol_database



class DescriptorPoolTestBase(object):

  def testFindFileByName(self):
    name1 = &#39;google/protobuf/internal/factory_test1.proto&#39;
    file_desc1 = self.pool.FindFileByName(name1)
    self.assertIsInstance(file_desc1, descriptor.FileDescriptor)
    self.assertEqual(name1, file_desc1.name)
    self.assertEqual(&#39;google.protobuf.python.internal&#39;, file_desc1.package)
    self.assertIn(&#39;Factory1Message&#39;, file_desc1.message_types_by_name)

    name2 = &#39;google/protobuf/internal/factory_test2.proto&#39;
    file_desc2 = self.pool.FindFileByName(name2)
    self.assertIsInstance(file_desc2, descriptor.FileDescriptor)
    self.assertEqual(name2, file_desc2.name)
    self.assertEqual(&#39;google.protobuf.python.internal&#39;, file_desc2.package)
    self.assertIn(&#39;Factory2Message&#39;, file_desc2.message_types_by_name)

  def testFindFileByNameFailure(self):
    with self.assertRaises(KeyError):
      self.pool.FindFileByName(&#39;Does not exist&#39;)

  def testFindFileContainingSymbol(self):
    file_desc1 = self.pool.FindFileContainingSymbol(
        &#39;google.protobuf.python.internal.Factory1Message&#39;)
    self.assertIsInstance(file_desc1, descriptor.FileDescriptor)
    self.assertEqual(&#39;google/protobuf/internal/factory_test1.proto&#39;,
                     file_desc1.name)
    self.assertEqual(&#39;google.protobuf.python.internal&#39;, file_desc1.package)
    self.assertIn(&#39;Factory1Message&#39;, file_desc1.message_types_by_name)

    file_desc2 = self.pool.FindFileContainingSymbol(
        &#39;google.protobuf.python.internal.Factory2Message&#39;)
    self.assertIsInstance(file_desc2, descriptor.FileDescriptor)
    self.assertEqual(&#39;google/protobuf/internal/factory_test2.proto&#39;,
                     file_desc2.name)
    self.assertEqual(&#39;google.protobuf.python.internal&#39;, file_desc2.package)
    self.assertIn(&#39;Factory2Message&#39;, file_desc2.message_types_by_name)

    # Tests top level extension.
    file_desc3 = self.pool.FindFileContainingSymbol(
        &#39;google.protobuf.python.internal.another_field&#39;)
    self.assertIsInstance(file_desc3, descriptor.FileDescriptor)
    self.assertEqual(&#39;google/protobuf/internal/factory_test2.proto&#39;,
                     file_desc3.name)

    # Tests nested extension inside a message.
    file_desc4 = self.pool.FindFileContainingSymbol(
        &#39;google.protobuf.python.internal.Factory2Message.one_more_field&#39;)
    self.assertIsInstance(file_desc4, descriptor.FileDescriptor)
    self.assertEqual(&#39;google/protobuf/internal/factory_test2.proto&#39;,
                     file_desc4.name)

    file_desc5 = self.pool.FindFileContainingSymbol(
        &#39;protobuf_unittest.TestService&#39;)
    self.assertIsInstance(file_desc5, descriptor.FileDescriptor)
    self.assertEqual(&#39;google/protobuf/unittest.proto&#39;,
                     file_desc5.name)
    # Tests the generated pool.
    assert descriptor_pool.Default().FindFileContainingSymbol(
        &#39;google.protobuf.python.internal.Factory2Message.one_more_field&#39;)
    assert descriptor_pool.Default().FindFileContainingSymbol(
        &#39;google.protobuf.python.internal.another_field&#39;)
    assert descriptor_pool.Default().FindFileContainingSymbol(
        &#39;protobuf_unittest.TestService&#39;)

    # Can find field.
    file_desc6 = self.pool.FindFileContainingSymbol(
        &#39;google.protobuf.python.internal.Factory1Message.list_value&#39;)
    self.assertIsInstance(file_desc6, descriptor.FileDescriptor)
    self.assertEqual(&#39;google/protobuf/internal/factory_test1.proto&#39;,
                     file_desc6.name)

    # Can find top level Enum value.
    file_desc7 = self.pool.FindFileContainingSymbol(
        &#39;google.protobuf.python.internal.FACTORY_1_VALUE_0&#39;)
    self.assertIsInstance(file_desc7, descriptor.FileDescriptor)
    self.assertEqual(&#39;google/protobuf/internal/factory_test1.proto&#39;,
                     file_desc7.name)

    # Can find nested Enum value.
    file_desc8 = self.pool.FindFileContainingSymbol(
        &#39;protobuf_unittest.TestAllTypes.FOO&#39;)
    self.assertIsInstance(file_desc8, descriptor.FileDescriptor)
    self.assertEqual(&#39;google/protobuf/unittest.proto&#39;,
                     file_desc8.name)

    # TODO(jieluo): Add tests for no package when b/13860351 is fixed.

    self.assertRaises(KeyError, self.pool.FindFileContainingSymbol,
                      &#39;google.protobuf.python.internal.Factory1Message.none_field&#39;)

  def testFindFileContainingSymbolFailure(self):
    with self.assertRaises(KeyError):
      self.pool.FindFileContainingSymbol(&#39;Does not exist&#39;)

  def testFindMessageTypeByName(self):
    msg1 = self.pool.FindMessageTypeByName(
        &#39;google.protobuf.python.internal.Factory1Message&#39;)
    self.assertIsInstance(msg1, descriptor.Descriptor)
    self.assertEqual(&#39;Factory1Message&#39;, msg1.name)
    self.assertEqual(&#39;google.protobuf.python.internal.Factory1Message&#39;,
                     msg1.full_name)
    self.assertEqual(None, msg1.containing_type)
    self.assertFalse(msg1.has_options)

    nested_msg1 = msg1.nested_types[0]
    self.assertEqual(&#39;NestedFactory1Message&#39;, nested_msg1.name)
    self.assertEqual(msg1, nested_msg1.containing_type)

    nested_enum1 = msg1.enum_types[0]
    self.assertEqual(&#39;NestedFactory1Enum&#39;, nested_enum1.name)
    self.assertEqual(msg1, nested_enum1.containing_type)

    self.assertEqual(nested_msg1, msg1.fields_by_name[
        &#39;nested_factory_1_message&#39;].message_type)
    self.assertEqual(nested_enum1, msg1.fields_by_name[
        &#39;nested_factory_1_enum&#39;].enum_type)

    msg2 = self.pool.FindMessageTypeByName(
        &#39;google.protobuf.python.internal.Factory2Message&#39;)
    self.assertIsInstance(msg2, descriptor.Descriptor)
    self.assertEqual(&#39;Factory2Message&#39;, msg2.name)
    self.assertEqual(&#39;google.protobuf.python.internal.Factory2Message&#39;,
                     msg2.full_name)
    self.assertIsNone(msg2.containing_type)

    nested_msg2 = msg2.nested_types[0]
    self.assertEqual(&#39;NestedFactory2Message&#39;, nested_msg2.name)
    self.assertEqual(msg2, nested_msg2.containing_type)

    nested_enum2 = msg2.enum_types[0]
    self.assertEqual(&#39;NestedFactory2Enum&#39;, nested_enum2.name)
    self.assertEqual(msg2, nested_enum2.containing_type)

    self.assertEqual(nested_msg2, msg2.fields_by_name[
        &#39;nested_factory_2_message&#39;].message_type)
    self.assertEqual(nested_enum2, msg2.fields_by_name[
        &#39;nested_factory_2_enum&#39;].enum_type)

    self.assertTrue(msg2.fields_by_name[&#39;int_with_default&#39;].has_default_value)
    self.assertEqual(
        1776, msg2.fields_by_name[&#39;int_with_default&#39;].default_value)

    self.assertTrue(
        msg2.fields_by_name[&#39;double_with_default&#39;].has_default_value)
    self.assertEqual(
        9.99, msg2.fields_by_name[&#39;double_with_default&#39;].default_value)

    self.assertTrue(
        msg2.fields_by_name[&#39;string_with_default&#39;].has_default_value)
    self.assertEqual(
        &#39;hello world&#39;, msg2.fields_by_name[&#39;string_with_default&#39;].default_value)

    self.assertTrue(msg2.fields_by_name[&#39;bool_with_default&#39;].has_default_value)
    self.assertFalse(msg2.fields_by_name[&#39;bool_with_default&#39;].default_value)

    self.assertTrue(msg2.fields_by_name[&#39;enum_with_default&#39;].has_default_value)
    self.assertEqual(
        1, msg2.fields_by_name[&#39;enum_with_default&#39;].default_value)

    msg3 = self.pool.FindMessageTypeByName(
        &#39;google.protobuf.python.internal.Factory2Message.NestedFactory2Message&#39;)
    self.assertEqual(nested_msg2, msg3)

    self.assertTrue(msg2.fields_by_name[&#39;bytes_with_default&#39;].has_default_value)
    self.assertEqual(
        b&#39;a\xfb\x00c&#39;,
        msg2.fields_by_name[&#39;bytes_with_default&#39;].default_value)

    self.assertEqual(1, len(msg2.oneofs))
    self.assertEqual(1, len(msg2.oneofs_by_name))
    self.assertEqual(2, len(msg2.oneofs[0].fields))
    for name in [&#39;oneof_int&#39;, &#39;oneof_string&#39;]:
      self.assertEqual(msg2.oneofs[0],
                       msg2.fields_by_name[name].containing_oneof)
      self.assertIn(msg2.fields_by_name[name], msg2.oneofs[0].fields)

  def testFindTypeErrors(self):
    self.assertRaises(TypeError, self.pool.FindExtensionByNumber, &#39;&#39;)
    self.assertRaises(KeyError, self.pool.FindMethodByName, &#39;&#39;)

    # TODO(jieluo): Fix python to raise correct errors.
    if api_implementation.Type() == &#39;cpp&#39;:
      error_type = TypeError
    else:
      error_type = AttributeError
    self.assertRaises(error_type, self.pool.FindMessageTypeByName, 0)
    self.assertRaises(error_type, self.pool.FindFieldByName, 0)
    self.assertRaises(error_type, self.pool.FindExtensionByName, 0)
    self.assertRaises(error_type, self.pool.FindEnumTypeByName, 0)
    self.assertRaises(error_type, self.pool.FindOneofByName, 0)
    self.assertRaises(error_type, self.pool.FindServiceByName, 0)
    self.assertRaises(error_type, self.pool.FindMethodByName, 0)
    self.assertRaises(error_type, self.pool.FindFileContainingSymbol, 0)
    if api_implementation.Type() == &#39;python&#39;:
      error_type = KeyError
    self.assertRaises(error_type, self.pool.FindFileByName, 0)

  def testFindMessageTypeByNameFailure(self):
    with self.assertRaises(KeyError):
      self.pool.FindMessageTypeByName(&#39;Does not exist&#39;)

  def testFindEnumTypeByName(self):
    enum1 = self.pool.FindEnumTypeByName(
        &#39;google.protobuf.python.internal.Factory1Enum&#39;)
    self.assertIsInstance(enum1, descriptor.EnumDescriptor)
    self.assertEqual(0, enum1.values_by_name[&#39;FACTORY_1_VALUE_0&#39;].number)
    self.assertEqual(1, enum1.values_by_name[&#39;FACTORY_1_VALUE_1&#39;].number)
    self.assertFalse(enum1.has_options)

    nested_enum1 = self.pool.FindEnumTypeByName(
        &#39;google.protobuf.python.internal.Factory1Message.NestedFactory1Enum&#39;)
    self.assertIsInstance(nested_enum1, descriptor.EnumDescriptor)
    self.assertEqual(
        0, nested_enum1.values_by_name[&#39;NESTED_FACTORY_1_VALUE_0&#39;].number)
    self.assertEqual(
        1, nested_enum1.values_by_name[&#39;NESTED_FACTORY_1_VALUE_1&#39;].number)

    enum2 = self.pool.FindEnumTypeByName(
        &#39;google.protobuf.python.internal.Factory2Enum&#39;)
    self.assertIsInstance(enum2, descriptor.EnumDescriptor)
    self.assertEqual(0, enum2.values_by_name[&#39;FACTORY_2_VALUE_0&#39;].number)
    self.assertEqual(1, enum2.values_by_name[&#39;FACTORY_2_VALUE_1&#39;].number)

    nested_enum2 = self.pool.FindEnumTypeByName(
        &#39;google.protobuf.python.internal.Factory2Message.NestedFactory2Enum&#39;)
    self.assertIsInstance(nested_enum2, descriptor.EnumDescriptor)
    self.assertEqual(
        0, nested_enum2.values_by_name[&#39;NESTED_FACTORY_2_VALUE_0&#39;].number)
    self.assertEqual(
        1, nested_enum2.values_by_name[&#39;NESTED_FACTORY_2_VALUE_1&#39;].number)

  def testFindEnumTypeByNameFailure(self):
    with self.assertRaises(KeyError):
      self.pool.FindEnumTypeByName(&#39;Does not exist&#39;)

  def testFindFieldByName(self):
    field = self.pool.FindFieldByName(
        &#39;google.protobuf.python.internal.Factory1Message.list_value&#39;)
    self.assertEqual(field.name, &#39;list_value&#39;)
    self.assertEqual(field.label, field.LABEL_REPEATED)
    self.assertFalse(field.has_options)

    with self.assertRaises(KeyError):
      self.pool.FindFieldByName(&#39;Does not exist&#39;)

  def testFindOneofByName(self):
    oneof = self.pool.FindOneofByName(
        &#39;google.protobuf.python.internal.Factory2Message.oneof_field&#39;)
    self.assertEqual(oneof.name, &#39;oneof_field&#39;)
    with self.assertRaises(KeyError):
      self.pool.FindOneofByName(&#39;Does not exist&#39;)

  def testFindExtensionByName(self):
    # An extension defined in a message.
    extension = self.pool.FindExtensionByName(
        &#39;google.protobuf.python.internal.Factory2Message.one_more_field&#39;)
    self.assertEqual(extension.name, &#39;one_more_field&#39;)
    # An extension defined at file scope.
    extension = self.pool.FindExtensionByName(
        &#39;google.protobuf.python.internal.another_field&#39;)
    self.assertEqual(extension.name, &#39;another_field&#39;)
    self.assertEqual(extension.number, 1002)
    with self.assertRaises(KeyError):
      self.pool.FindFieldByName(&#39;Does not exist&#39;)

  def testFindAllExtensions(self):
    factory1_message = self.pool.FindMessageTypeByName(
        &#39;google.protobuf.python.internal.Factory1Message&#39;)
    factory2_message = self.pool.FindMessageTypeByName(
        &#39;google.protobuf.python.internal.Factory2Message&#39;)
    # An extension defined in a message.
    one_more_field = factory2_message.extensions_by_name[&#39;one_more_field&#39;]
    self.pool.AddExtensionDescriptor(one_more_field)
    # An extension defined at file scope.
    factory_test2 = self.pool.FindFileByName(
        &#39;google/protobuf/internal/factory_test2.proto&#39;)
    another_field = factory_test2.extensions_by_name[&#39;another_field&#39;]
    self.pool.AddExtensionDescriptor(another_field)

    extensions = self.pool.FindAllExtensions(factory1_message)
    expected_extension_numbers = set([one_more_field, another_field])
    self.assertEqual(expected_extension_numbers, set(extensions))
    # Verify that mutating the returned list does not affect the pool.
    extensions.append(&#39;unexpected_element&#39;)
    # Get the extensions again, the returned value does not contain the
    # &#39;unexpected_element&#39;.
    extensions = self.pool.FindAllExtensions(factory1_message)
    self.assertEqual(expected_extension_numbers, set(extensions))

  def testFindExtensionByNumber(self):
    factory1_message = self.pool.FindMessageTypeByName(
        &#39;google.protobuf.python.internal.Factory1Message&#39;)
    factory2_message = self.pool.FindMessageTypeByName(
        &#39;google.protobuf.python.internal.Factory2Message&#39;)
    # An extension defined in a message.
    one_more_field = factory2_message.extensions_by_name[&#39;one_more_field&#39;]
    self.pool.AddExtensionDescriptor(one_more_field)
    # An extension defined at file scope.
    factory_test2 = self.pool.FindFileByName(
        &#39;google/protobuf/internal/factory_test2.proto&#39;)
    another_field = factory_test2.extensions_by_name[&#39;another_field&#39;]
    self.pool.AddExtensionDescriptor(another_field)

    # An extension defined in a message.
    extension = self.pool.FindExtensionByNumber(factory1_message, 1001)
    self.assertEqual(extension.name, &#39;one_more_field&#39;)
    # An extension defined at file scope.
    extension = self.pool.FindExtensionByNumber(factory1_message, 1002)
    self.assertEqual(extension.name, &#39;another_field&#39;)
    with self.assertRaises(KeyError):
      extension = self.pool.FindExtensionByNumber(factory1_message, 1234567)

  def testExtensionsAreNotFields(self):
    with self.assertRaises(KeyError):
      self.pool.FindFieldByName(&#39;google.protobuf.python.internal.another_field&#39;)
    with self.assertRaises(KeyError):
      self.pool.FindFieldByName(
          &#39;google.protobuf.python.internal.Factory2Message.one_more_field&#39;)
    with self.assertRaises(KeyError):
      self.pool.FindExtensionByName(
          &#39;google.protobuf.python.internal.Factory1Message.list_value&#39;)

  def testFindService(self):
    service = self.pool.FindServiceByName(&#39;protobuf_unittest.TestService&#39;)
    self.assertEqual(service.full_name, &#39;protobuf_unittest.TestService&#39;)
    with self.assertRaises(KeyError):
      self.pool.FindServiceByName(&#39;Does not exist&#39;)

    method = self.pool.FindMethodByName(&#39;protobuf_unittest.TestService.Foo&#39;)
    self.assertIs(method.containing_service, service)
    with self.assertRaises(KeyError):
      self.pool.FindMethodByName(&#39;protobuf_unittest.TestService.Doesnotexist&#39;)

  def testUserDefinedDB(self):
    db = descriptor_database.DescriptorDatabase()
    self.pool = descriptor_pool.DescriptorPool(db)
    db.Add(self.factory_test1_fd)
    db.Add(self.factory_test2_fd)
    self.testFindMessageTypeByName()

  def testAddSerializedFile(self):
    if isinstance(self, SecondaryDescriptorFromDescriptorDB):
      if api_implementation.Type() == &#39;cpp&#39;:
        # Cpp extension cannot call Add on a DescriptorPool
        # that uses a DescriptorDatabase.
        # TODO(jieluo): Fix python and cpp extension diff.
        return
    self.pool = descriptor_pool.DescriptorPool()
    self.pool.AddSerializedFile(self.factory_test1_fd.SerializeToString())
    self.pool.AddSerializedFile(self.factory_test2_fd.SerializeToString())
    self.testFindMessageTypeByName()


  def testEnumDefaultValue(self):
    &#34;&#34;&#34;Test the default value of enums which don&#39;t start at zero.&#34;&#34;&#34;
    def _CheckDefaultValue(file_descriptor):
      default_value = (file_descriptor
                       .message_types_by_name[&#39;DescriptorPoolTest1&#39;]
                       .fields_by_name[&#39;nested_enum&#39;]
                       .default_value)
      self.assertEqual(default_value,
                       descriptor_pool_test1_pb2.DescriptorPoolTest1.BETA)
    # First check what the generated descriptor contains.
    _CheckDefaultValue(descriptor_pool_test1_pb2.DESCRIPTOR)
    # Then check the generated pool. Normally this is the same descriptor.
    file_descriptor = symbol_database.Default().pool.FindFileByName(
        &#39;google/protobuf/internal/descriptor_pool_test1.proto&#39;)
    self.assertIs(file_descriptor, descriptor_pool_test1_pb2.DESCRIPTOR)
    _CheckDefaultValue(file_descriptor)

    if isinstance(self, SecondaryDescriptorFromDescriptorDB):
      if api_implementation.Type() == &#39;cpp&#39;:
        # Cpp extension cannot call Add on a DescriptorPool
        # that uses a DescriptorDatabase.
        # TODO(jieluo): Fix python and cpp extension diff.
        return
    # Then check the dynamic pool and its internal DescriptorDatabase.
    descriptor_proto = descriptor_pb2.FileDescriptorProto.FromString(
        descriptor_pool_test1_pb2.DESCRIPTOR.serialized_pb)
    self.pool.Add(descriptor_proto)
    # And do the same check as above
    file_descriptor = self.pool.FindFileByName(
        &#39;google/protobuf/internal/descriptor_pool_test1.proto&#39;)
    _CheckDefaultValue(file_descriptor)

  def testDefaultValueForCustomMessages(self):
    &#34;&#34;&#34;Check the value returned by non-existent fields.&#34;&#34;&#34;
    def _CheckValueAndType(value, expected_value, expected_type):
      self.assertEqual(value, expected_value)
      self.assertIsInstance(value, expected_type)

    def _CheckDefaultValues(msg):
      try:
        int64 = long
      except NameError:  # Python3
        int64 = int
      try:
        unicode_type = unicode
      except NameError:  # Python3
        unicode_type = str
      _CheckValueAndType(msg.optional_int32, 0, int)
      _CheckValueAndType(msg.optional_uint64, 0, (int64, int))
      _CheckValueAndType(msg.optional_float, 0, (float, int))
      _CheckValueAndType(msg.optional_double, 0, (float, int))
      _CheckValueAndType(msg.optional_bool, False, bool)
      _CheckValueAndType(msg.optional_string, u&#39;&#39;, unicode_type)
      _CheckValueAndType(msg.optional_bytes, b&#39;&#39;, bytes)
      _CheckValueAndType(msg.optional_nested_enum, msg.FOO, int)
    # First for the generated message
    _CheckDefaultValues(unittest_pb2.TestAllTypes())
    # Then for a message built with from the DescriptorPool.
    pool = descriptor_pool.DescriptorPool()
    pool.Add(descriptor_pb2.FileDescriptorProto.FromString(
        unittest_import_public_pb2.DESCRIPTOR.serialized_pb))
    pool.Add(descriptor_pb2.FileDescriptorProto.FromString(
        unittest_import_pb2.DESCRIPTOR.serialized_pb))
    pool.Add(descriptor_pb2.FileDescriptorProto.FromString(
        unittest_pb2.DESCRIPTOR.serialized_pb))
    message_class = message_factory.MessageFactory(pool).GetPrototype(
        pool.FindMessageTypeByName(
            unittest_pb2.TestAllTypes.DESCRIPTOR.full_name))
    _CheckDefaultValues(message_class())

  def testAddFileDescriptor(self):
    if isinstance(self, SecondaryDescriptorFromDescriptorDB):
      if api_implementation.Type() == &#39;cpp&#39;:
        # Cpp extension cannot call Add on a DescriptorPool
        # that uses a DescriptorDatabase.
        # TODO(jieluo): Fix python and cpp extension diff.
        return
    file_desc = descriptor_pb2.FileDescriptorProto(name=&#39;some/file.proto&#39;)
    self.pool.Add(file_desc)
    self.pool.AddSerializedFile(file_desc.SerializeToString())

  def testComplexNesting(self):
    if isinstance(self, SecondaryDescriptorFromDescriptorDB):
      if api_implementation.Type() == &#39;cpp&#39;:
        # Cpp extension cannot call Add on a DescriptorPool
        # that uses a DescriptorDatabase.
        # TODO(jieluo): Fix python and cpp extension diff.
        return
    more_messages_desc = descriptor_pb2.FileDescriptorProto.FromString(
        more_messages_pb2.DESCRIPTOR.serialized_pb)
    test1_desc = descriptor_pb2.FileDescriptorProto.FromString(
        descriptor_pool_test1_pb2.DESCRIPTOR.serialized_pb)
    test2_desc = descriptor_pb2.FileDescriptorProto.FromString(
        descriptor_pool_test2_pb2.DESCRIPTOR.serialized_pb)
    self.pool.Add(more_messages_desc)
    self.pool.Add(test1_desc)
    self.pool.Add(test2_desc)
    TEST1_FILE.CheckFile(self, self.pool)
    TEST2_FILE.CheckFile(self, self.pool)

  def testConflictRegister(self):
    if isinstance(self, SecondaryDescriptorFromDescriptorDB):
      if api_implementation.Type() == &#39;cpp&#39;:
        # Cpp extension cannot call Add on a DescriptorPool
        # that uses a DescriptorDatabase.
        # TODO(jieluo): Fix python and cpp extension diff.
        return
    unittest_fd = descriptor_pb2.FileDescriptorProto.FromString(
        unittest_pb2.DESCRIPTOR.serialized_pb)
    conflict_fd = copy.deepcopy(unittest_fd)
    conflict_fd.name = &#39;other_file&#39;
    if api_implementation.Type() == &#39;cpp&#39;:
        pass
    else:
      pool = copy.deepcopy(self.pool)
      file_descriptor = unittest_pb2.DESCRIPTOR
      pool.AddDescriptor(
          file_descriptor.message_types_by_name[&#39;TestAllTypes&#39;])
      pool.AddEnumDescriptor(
          file_descriptor.enum_types_by_name[&#39;ForeignEnum&#39;])
      pool.AddServiceDescriptor(
          file_descriptor.services_by_name[&#39;TestService&#39;])
      pool.AddExtensionDescriptor(
          file_descriptor.extensions_by_name[&#39;optional_int32_extension&#39;])
      pool.Add(unittest_fd)
      pool.Add(conflict_fd)
      pool.FindFileByName(unittest_fd.name)
      with self.assertRaises(TypeError):
        pool.FindFileByName(conflict_fd.name)


@testing_refleaks.TestCase
class DefaultDescriptorPoolTest(DescriptorPoolTestBase, unittest.TestCase):

  def setUp(self):
    self.pool = descriptor_pool.Default()
    self.factory_test1_fd = descriptor_pb2.FileDescriptorProto.FromString(
        factory_test1_pb2.DESCRIPTOR.serialized_pb)
    self.factory_test2_fd = descriptor_pb2.FileDescriptorProto.FromString(
        factory_test2_pb2.DESCRIPTOR.serialized_pb)

  def testFindMethods(self):
    self.assertIs(
        self.pool.FindFileByName(&#39;google/protobuf/unittest.proto&#39;),
        unittest_pb2.DESCRIPTOR)
    self.assertIs(
        self.pool.FindMessageTypeByName(&#39;protobuf_unittest.TestAllTypes&#39;),
        unittest_pb2.TestAllTypes.DESCRIPTOR)
    self.assertIs(
        self.pool.FindFieldByName(
            &#39;protobuf_unittest.TestAllTypes.optional_int32&#39;),
        unittest_pb2.TestAllTypes.DESCRIPTOR.fields_by_name[&#39;optional_int32&#39;])
    self.assertIs(
        self.pool.FindEnumTypeByName(&#39;protobuf_unittest.ForeignEnum&#39;),
        unittest_pb2.ForeignEnum.DESCRIPTOR)
    self.assertIs(
        self.pool.FindExtensionByName(
            &#39;protobuf_unittest.optional_int32_extension&#39;),
        unittest_pb2.DESCRIPTOR.extensions_by_name[&#39;optional_int32_extension&#39;])
    self.assertIs(
        self.pool.FindOneofByName(&#39;protobuf_unittest.TestAllTypes.oneof_field&#39;),
        unittest_pb2.TestAllTypes.DESCRIPTOR.oneofs_by_name[&#39;oneof_field&#39;])
    self.assertIs(
        self.pool.FindServiceByName(&#39;protobuf_unittest.TestService&#39;),
        unittest_pb2.DESCRIPTOR.services_by_name[&#39;TestService&#39;])


@testing_refleaks.TestCase
class CreateDescriptorPoolTest(DescriptorPoolTestBase, unittest.TestCase):

  def setUp(self):
    self.pool = descriptor_pool.DescriptorPool()
    self.factory_test1_fd = descriptor_pb2.FileDescriptorProto.FromString(
        factory_test1_pb2.DESCRIPTOR.serialized_pb)
    self.factory_test2_fd = descriptor_pb2.FileDescriptorProto.FromString(
        factory_test2_pb2.DESCRIPTOR.serialized_pb)
    self.pool.Add(self.factory_test1_fd)
    self.pool.Add(self.factory_test2_fd)

    self.pool.Add(descriptor_pb2.FileDescriptorProto.FromString(
        unittest_import_public_pb2.DESCRIPTOR.serialized_pb))
    self.pool.Add(descriptor_pb2.FileDescriptorProto.FromString(
        unittest_import_pb2.DESCRIPTOR.serialized_pb))
    self.pool.Add(descriptor_pb2.FileDescriptorProto.FromString(
        unittest_pb2.DESCRIPTOR.serialized_pb))
    self.pool.Add(descriptor_pb2.FileDescriptorProto.FromString(
        no_package_pb2.DESCRIPTOR.serialized_pb))


@testing_refleaks.TestCase
class SecondaryDescriptorFromDescriptorDB(DescriptorPoolTestBase,
                                          unittest.TestCase):

  def setUp(self):
    self.factory_test1_fd = descriptor_pb2.FileDescriptorProto.FromString(
        factory_test1_pb2.DESCRIPTOR.serialized_pb)
    self.factory_test2_fd = descriptor_pb2.FileDescriptorProto.FromString(
        factory_test2_pb2.DESCRIPTOR.serialized_pb)
    self.db = descriptor_database.DescriptorDatabase()
    self.db.Add(self.factory_test1_fd)
    self.db.Add(self.factory_test2_fd)
    self.db.Add(descriptor_pb2.FileDescriptorProto.FromString(
        unittest_import_public_pb2.DESCRIPTOR.serialized_pb))
    self.db.Add(descriptor_pb2.FileDescriptorProto.FromString(
        unittest_import_pb2.DESCRIPTOR.serialized_pb))
    self.db.Add(descriptor_pb2.FileDescriptorProto.FromString(
        unittest_pb2.DESCRIPTOR.serialized_pb))
    self.db.Add(descriptor_pb2.FileDescriptorProto.FromString(
        no_package_pb2.DESCRIPTOR.serialized_pb))
    self.pool = descriptor_pool.DescriptorPool(descriptor_db=self.db)

  def testErrorCollector(self):
    file_proto = descriptor_pb2.FileDescriptorProto()
    file_proto.package = &#39;collector&#39;
    file_proto.name = &#39;error_file&#39;
    message_type = file_proto.message_type.add()
    message_type.name = &#39;ErrorMessage&#39;
    field = message_type.field.add()
    field.number = 1
    field.name = &#39;nested_message_field&#39;
    field.label = descriptor.FieldDescriptor.LABEL_OPTIONAL
    field.type = descriptor.FieldDescriptor.TYPE_MESSAGE
    field.type_name = &#39;SubMessage&#39;
    oneof = message_type.oneof_decl.add()
    oneof.name = &#39;MyOneof&#39;
    enum_type = file_proto.enum_type.add()
    enum_type.name = &#39;MyEnum&#39;
    enum_value = enum_type.value.add()
    enum_value.name = &#39;MyEnumValue&#39;
    enum_value.number = 0
    self.db.Add(file_proto)

    self.assertRaisesRegexp(KeyError, &#39;SubMessage&#39;,
                            self.pool.FindMessageTypeByName,
                            &#39;collector.ErrorMessage&#39;)
    self.assertRaisesRegexp(KeyError, &#39;SubMessage&#39;,
                            self.pool.FindFileByName, &#39;error_file&#39;)
    with self.assertRaises(KeyError) as exc:
      self.pool.FindFileByName(&#39;none_file&#39;)
    self.assertIn(str(exc.exception), (&#39;\&#39;none_file\&#39;&#39;,
                                       &#39;\&#34;Couldn\&#39;t find file none_file\&#34;&#39;))

    # Pure python _ConvertFileProtoToFileDescriptor() method has side effect
    # that all the symbols found in the file will load into the pool even the
    # file can not build. So when FindMessageTypeByName(&#39;ErrorMessage&#39;) was
    # called the first time, a KeyError will be raised but call the find
    # method later will return a descriptor which is not build.
    # TODO(jieluo): fix pure python to revert the load if file can not be build
    if api_implementation.Type() == &#39;cpp&#39;:
      error_msg = (&#39;Invalid proto descriptor for file &#34;error_file&#34;:\\n  &#39;
                   &#39;collector.ErrorMessage.nested_message_field: &#34;SubMessage&#34; &#39;
                   &#39;is not defined.\\n  collector.ErrorMessage.MyOneof: Oneof &#39;
                   &#39;must have at least one field.\\n\&#39;&#39;)
      with self.assertRaises(KeyError) as exc:
        self.pool.FindMessageTypeByName(&#39;collector.ErrorMessage&#39;)
      self.assertEqual(str(exc.exception), &#39;\&#39;Couldn\\\&#39;t build file for &#39;
                       &#39;message collector.ErrorMessage\\n&#39; + error_msg)

      with self.assertRaises(KeyError) as exc:
        self.pool.FindFieldByName(&#39;collector.ErrorMessage.nested_message_field&#39;)
      self.assertEqual(str(exc.exception), &#39;\&#39;Couldn\\\&#39;t build file for field&#39;
                       &#39; collector.ErrorMessage.nested_message_field\\n&#39;
                       + error_msg)

      with self.assertRaises(KeyError) as exc:
        self.pool.FindEnumTypeByName(&#39;collector.MyEnum&#39;)
      self.assertEqual(str(exc.exception), &#39;\&#39;Couldn\\\&#39;t build file for enum&#39;
                       &#39; collector.MyEnum\\n&#39; + error_msg)

      with self.assertRaises(KeyError) as exc:
        self.pool.FindFileContainingSymbol(&#39;collector.MyEnumValue&#39;)
      self.assertEqual(str(exc.exception), &#39;\&#39;Couldn\\\&#39;t build file for symbol&#39;
                       &#39; collector.MyEnumValue\\n&#39; + error_msg)

      with self.assertRaises(KeyError) as exc:
        self.pool.FindOneofByName(&#39;collector.ErrorMessage.MyOneof&#39;)
      self.assertEqual(str(exc.exception), &#39;\&#39;Couldn\\\&#39;t build file for oneof&#39;
                       &#39; collector.ErrorMessage.MyOneof\\n&#39; + error_msg)


class ProtoFile(object):

  def __init__(self, name, package, messages, dependencies=None,
               public_dependencies=None):
    self.name = name
    self.package = package
    self.messages = messages
    self.dependencies = dependencies or []
    self.public_dependencies = public_dependencies or []

  def CheckFile(self, test, pool):
    file_desc = pool.FindFileByName(self.name)
    test.assertEqual(self.name, file_desc.name)
    test.assertEqual(self.package, file_desc.package)
    dependencies_names = [f.name for f in file_desc.dependencies]
    test.assertEqual(self.dependencies, dependencies_names)
    public_dependencies_names = [f.name for f in file_desc.public_dependencies]
    test.assertEqual(self.public_dependencies, public_dependencies_names)
    for name, msg_type in self.messages.items():
      msg_type.CheckType(test, None, name, file_desc)


class EnumType(object):

  def __init__(self, values):
    self.values = values

  def CheckType(self, test, msg_desc, name, file_desc):
    enum_desc = msg_desc.enum_types_by_name[name]
    test.assertEqual(name, enum_desc.name)
    expected_enum_full_name = &#39;.&#39;.join([msg_desc.full_name, name])
    test.assertEqual(expected_enum_full_name, enum_desc.full_name)
    test.assertEqual(msg_desc, enum_desc.containing_type)
    test.assertEqual(file_desc, enum_desc.file)
    for index, (value, number) in enumerate(self.values):
      value_desc = enum_desc.values_by_name[value]
      test.assertEqual(value, value_desc.name)
      test.assertEqual(index, value_desc.index)
      test.assertEqual(number, value_desc.number)
      test.assertEqual(enum_desc, value_desc.type)
      test.assertIn(value, msg_desc.enum_values_by_name)


class MessageType(object):

  def __init__(self, type_dict, field_list, is_extendable=False,
               extensions=None):
    self.type_dict = type_dict
    self.field_list = field_list
    self.is_extendable = is_extendable
    self.extensions = extensions or []

  def CheckType(self, test, containing_type_desc, name, file_desc):
    if containing_type_desc is None:
      desc = file_desc.message_types_by_name[name]
      expected_full_name = &#39;.&#39;.join([file_desc.package, name])
    else:
      desc = containing_type_desc.nested_types_by_name[name]
      expected_full_name = &#39;.&#39;.join([containing_type_desc.full_name, name])

    test.assertEqual(name, desc.name)
    test.assertEqual(expected_full_name, desc.full_name)
    test.assertEqual(containing_type_desc, desc.containing_type)
    test.assertEqual(desc.file, file_desc)
    test.assertEqual(self.is_extendable, desc.is_extendable)
    for name, subtype in self.type_dict.items():
      subtype.CheckType(test, desc, name, file_desc)

    for index, (name, field) in enumerate(self.field_list):
      field.CheckField(test, desc, name, index, file_desc)

    for index, (name, field) in enumerate(self.extensions):
      field.CheckField(test, desc, name, index, file_desc)


class EnumField(object):

  def __init__(self, number, type_name, default_value):
    self.number = number
    self.type_name = type_name
    self.default_value = default_value

  def CheckField(self, test, msg_desc, name, index, file_desc):
    field_desc = msg_desc.fields_by_name[name]
    enum_desc = msg_desc.enum_types_by_name[self.type_name]
    test.assertEqual(name, field_desc.name)
    expected_field_full_name = &#39;.&#39;.join([msg_desc.full_name, name])
    test.assertEqual(expected_field_full_name, field_desc.full_name)
    test.assertEqual(index, field_desc.index)
    test.assertEqual(self.number, field_desc.number)
    test.assertEqual(descriptor.FieldDescriptor.TYPE_ENUM, field_desc.type)
    test.assertEqual(descriptor.FieldDescriptor.CPPTYPE_ENUM,
                     field_desc.cpp_type)
    test.assertTrue(field_desc.has_default_value)
    test.assertEqual(enum_desc.values_by_name[self.default_value].number,
                     field_desc.default_value)
    test.assertFalse(enum_desc.values_by_name[self.default_value].has_options)
    test.assertEqual(msg_desc, field_desc.containing_type)
    test.assertEqual(enum_desc, field_desc.enum_type)
    test.assertEqual(file_desc, enum_desc.file)


class MessageField(object):

  def __init__(self, number, type_name):
    self.number = number
    self.type_name = type_name

  def CheckField(self, test, msg_desc, name, index, file_desc):
    field_desc = msg_desc.fields_by_name[name]
    field_type_desc = msg_desc.nested_types_by_name[self.type_name]
    test.assertEqual(name, field_desc.name)
    expected_field_full_name = &#39;.&#39;.join([msg_desc.full_name, name])
    test.assertEqual(expected_field_full_name, field_desc.full_name)
    test.assertEqual(index, field_desc.index)
    test.assertEqual(self.number, field_desc.number)
    test.assertEqual(descriptor.FieldDescriptor.TYPE_MESSAGE, field_desc.type)
    test.assertEqual(descriptor.FieldDescriptor.CPPTYPE_MESSAGE,
                     field_desc.cpp_type)
    test.assertFalse(field_desc.has_default_value)
    test.assertEqual(msg_desc, field_desc.containing_type)
    test.assertEqual(field_type_desc, field_desc.message_type)
    test.assertEqual(file_desc, field_desc.file)
    test.assertEqual(field_desc.default_value, None)


class StringField(object):

  def __init__(self, number, default_value):
    self.number = number
    self.default_value = default_value

  def CheckField(self, test, msg_desc, name, index, file_desc):
    field_desc = msg_desc.fields_by_name[name]
    test.assertEqual(name, field_desc.name)
    expected_field_full_name = &#39;.&#39;.join([msg_desc.full_name, name])
    test.assertEqual(expected_field_full_name, field_desc.full_name)
    test.assertEqual(index, field_desc.index)
    test.assertEqual(self.number, field_desc.number)
    test.assertEqual(descriptor.FieldDescriptor.TYPE_STRING, field_desc.type)
    test.assertEqual(descriptor.FieldDescriptor.CPPTYPE_STRING,
                     field_desc.cpp_type)
    test.assertTrue(field_desc.has_default_value)
    test.assertEqual(self.default_value, field_desc.default_value)
    test.assertEqual(file_desc, field_desc.file)


class ExtensionField(object):

  def __init__(self, number, extended_type):
    self.number = number
    self.extended_type = extended_type

  def CheckField(self, test, msg_desc, name, index, file_desc):
    field_desc = msg_desc.extensions_by_name[name]
    test.assertEqual(name, field_desc.name)
    expected_field_full_name = &#39;.&#39;.join([msg_desc.full_name, name])
    test.assertEqual(expected_field_full_name, field_desc.full_name)
    test.assertEqual(self.number, field_desc.number)
    test.assertEqual(index, field_desc.index)
    test.assertEqual(descriptor.FieldDescriptor.TYPE_MESSAGE, field_desc.type)
    test.assertEqual(descriptor.FieldDescriptor.CPPTYPE_MESSAGE,
                     field_desc.cpp_type)
    test.assertFalse(field_desc.has_default_value)
    test.assertTrue(field_desc.is_extension)
    test.assertEqual(msg_desc, field_desc.extension_scope)
    test.assertEqual(msg_desc, field_desc.message_type)
    test.assertEqual(self.extended_type, field_desc.containing_type.name)
    test.assertEqual(file_desc, field_desc.file)


@testing_refleaks.TestCase
class AddDescriptorTest(unittest.TestCase):

  def _TestMessage(self, prefix):
    pool = descriptor_pool.DescriptorPool()
    pool.AddDescriptor(unittest_pb2.TestAllTypes.DESCRIPTOR)
    self.assertEqual(
        &#39;protobuf_unittest.TestAllTypes&#39;,
        pool.FindMessageTypeByName(
            prefix + &#39;protobuf_unittest.TestAllTypes&#39;).full_name)

    # AddDescriptor is not recursive.
    with self.assertRaises(KeyError):
      pool.FindMessageTypeByName(
          prefix + &#39;protobuf_unittest.TestAllTypes.NestedMessage&#39;)

    pool.AddDescriptor(unittest_pb2.TestAllTypes.NestedMessage.DESCRIPTOR)
    self.assertEqual(
        &#39;protobuf_unittest.TestAllTypes.NestedMessage&#39;,
        pool.FindMessageTypeByName(
            prefix + &#39;protobuf_unittest.TestAllTypes.NestedMessage&#39;).full_name)

    # Files are implicitly also indexed when messages are added.
    self.assertEqual(
        &#39;google/protobuf/unittest.proto&#39;,
        pool.FindFileByName(
            &#39;google/protobuf/unittest.proto&#39;).name)

    self.assertEqual(
        &#39;google/protobuf/unittest.proto&#39;,
        pool.FindFileContainingSymbol(
            prefix + &#39;protobuf_unittest.TestAllTypes.NestedMessage&#39;).name)

  @unittest.skipIf(api_implementation.Type() == &#39;cpp&#39;,
                   &#39;With the cpp implementation, Add() must be called first&#39;)
  def testMessage(self):
    self._TestMessage(&#39;&#39;)
    self._TestMessage(&#39;.&#39;)

  def _TestEnum(self, prefix):
    pool = descriptor_pool.DescriptorPool()
    pool.AddEnumDescriptor(unittest_pb2.ForeignEnum.DESCRIPTOR)
    self.assertEqual(
        &#39;protobuf_unittest.ForeignEnum&#39;,
        pool.FindEnumTypeByName(
            prefix + &#39;protobuf_unittest.ForeignEnum&#39;).full_name)

    # AddEnumDescriptor is not recursive.
    with self.assertRaises(KeyError):
      pool.FindEnumTypeByName(
          prefix + &#39;protobuf_unittest.ForeignEnum.NestedEnum&#39;)

    pool.AddEnumDescriptor(unittest_pb2.TestAllTypes.NestedEnum.DESCRIPTOR)
    self.assertEqual(
        &#39;protobuf_unittest.TestAllTypes.NestedEnum&#39;,
        pool.FindEnumTypeByName(
            prefix + &#39;protobuf_unittest.TestAllTypes.NestedEnum&#39;).full_name)

    # Files are implicitly also indexed when enums are added.
    self.assertEqual(
        &#39;google/protobuf/unittest.proto&#39;,
        pool.FindFileByName(
            &#39;google/protobuf/unittest.proto&#39;).name)

    self.assertEqual(
        &#39;google/protobuf/unittest.proto&#39;,
        pool.FindFileContainingSymbol(
            prefix + &#39;protobuf_unittest.TestAllTypes.NestedEnum&#39;).name)

  @unittest.skipIf(api_implementation.Type() == &#39;cpp&#39;,
                   &#39;With the cpp implementation, Add() must be called first&#39;)
  def testEnum(self):
    self._TestEnum(&#39;&#39;)
    self._TestEnum(&#39;.&#39;)

  @unittest.skipIf(api_implementation.Type() == &#39;cpp&#39;,
                   &#39;With the cpp implementation, Add() must be called first&#39;)
  def testService(self):
    pool = descriptor_pool.DescriptorPool()
    with self.assertRaises(KeyError):
      pool.FindServiceByName(&#39;protobuf_unittest.TestService&#39;)
    pool.AddServiceDescriptor(unittest_pb2._TESTSERVICE)
    self.assertEqual(
        &#39;protobuf_unittest.TestService&#39;,
        pool.FindServiceByName(&#39;protobuf_unittest.TestService&#39;).full_name)

  @unittest.skipIf(api_implementation.Type() == &#39;cpp&#39;,
                   &#39;With the cpp implementation, Add() must be called first&#39;)
  def testFile(self):
    pool = descriptor_pool.DescriptorPool()
    pool.AddFileDescriptor(unittest_pb2.DESCRIPTOR)
    self.assertEqual(
        &#39;google/protobuf/unittest.proto&#39;,
        pool.FindFileByName(
            &#39;google/protobuf/unittest.proto&#39;).name)

    # AddFileDescriptor is not recursive; messages and enums within files must
    # be explicitly registered.
    with self.assertRaises(KeyError):
      pool.FindFileContainingSymbol(
          &#39;protobuf_unittest.TestAllTypes&#39;)

  def testEmptyDescriptorPool(self):
    # Check that an empty DescriptorPool() contains no messages.
    pool = descriptor_pool.DescriptorPool()
    proto_file_name = descriptor_pb2.DESCRIPTOR.name
    self.assertRaises(KeyError, pool.FindFileByName, proto_file_name)
    # Add the above file to the pool
    file_descriptor = descriptor_pb2.FileDescriptorProto()
    descriptor_pb2.DESCRIPTOR.CopyToProto(file_descriptor)
    pool.Add(file_descriptor)
    # Now it exists.
    self.assertTrue(pool.FindFileByName(proto_file_name))

  def testCustomDescriptorPool(self):
    # Create a new pool, and add a file descriptor.
    pool = descriptor_pool.DescriptorPool()
    file_desc = descriptor_pb2.FileDescriptorProto(
        name=&#39;some/file.proto&#39;, package=&#39;package&#39;)
    file_desc.message_type.add(name=&#39;Message&#39;)
    pool.Add(file_desc)
    self.assertEqual(pool.FindFileByName(&#39;some/file.proto&#39;).name,
                     &#39;some/file.proto&#39;)
    self.assertEqual(pool.FindMessageTypeByName(&#39;package.Message&#39;).name,
                     &#39;Message&#39;)
    # Test no package
    file_proto = descriptor_pb2.FileDescriptorProto(
        name=&#39;some/filename/container.proto&#39;)
    message_proto = file_proto.message_type.add(
        name=&#39;TopMessage&#39;)
    message_proto.field.add(
        name=&#39;bb&#39;,
        number=1,
        type=descriptor_pb2.FieldDescriptorProto.TYPE_INT32,
        label=descriptor_pb2.FieldDescriptorProto.LABEL_OPTIONAL)
    enum_proto = file_proto.enum_type.add(name=&#39;TopEnum&#39;)
    enum_proto.value.add(name=&#39;FOREIGN_FOO&#39;, number=4)
    file_proto.service.add(name=&#39;TopService&#39;)
    pool = descriptor_pool.DescriptorPool()
    pool.Add(file_proto)
    self.assertEqual(&#39;TopMessage&#39;,
                     pool.FindMessageTypeByName(&#39;TopMessage&#39;).name)
    self.assertEqual(&#39;TopEnum&#39;, pool.FindEnumTypeByName(&#39;TopEnum&#39;).name)
    self.assertEqual(&#39;TopService&#39;, pool.FindServiceByName(&#39;TopService&#39;).name)

  def testFileDescriptorOptionsWithCustomDescriptorPool(self):
    # Create a descriptor pool, and add a new FileDescriptorProto to it.
    pool = descriptor_pool.DescriptorPool()
    file_name = &#39;file_descriptor_options_with_custom_descriptor_pool.proto&#39;
    file_descriptor_proto = descriptor_pb2.FileDescriptorProto(name=file_name)
    extension_id = file_options_test_pb2.foo_options
    file_descriptor_proto.options.Extensions[extension_id].foo_name = &#39;foo&#39;
    pool.Add(file_descriptor_proto)
    # The options set on the FileDescriptorProto should be available in the
    # descriptor even if they contain extensions that cannot be deserialized
    # using the pool.
    file_descriptor = pool.FindFileByName(file_name)
    options = file_descriptor.GetOptions()
    self.assertEqual(&#39;foo&#39;, options.Extensions[extension_id].foo_name)
    # The object returned by GetOptions() is cached.
    self.assertIs(options, file_descriptor.GetOptions())

  def testAddTypeError(self):
    pool = descriptor_pool.DescriptorPool()
    with self.assertRaises(TypeError):
      pool.AddDescriptor(0)
    with self.assertRaises(TypeError):
      pool.AddEnumDescriptor(0)
    with self.assertRaises(TypeError):
      pool.AddServiceDescriptor(0)
    with self.assertRaises(TypeError):
      pool.AddExtensionDescriptor(0)
    with self.assertRaises(TypeError):
      pool.AddFileDescriptor(0)


TEST1_FILE = ProtoFile(
    &#39;google/protobuf/internal/descriptor_pool_test1.proto&#39;,
    &#39;google.protobuf.python.internal&#39;,
    {
        &#39;DescriptorPoolTest1&#39;: MessageType({
            &#39;NestedEnum&#39;: EnumType([(&#39;ALPHA&#39;, 1), (&#39;BETA&#39;, 2)]),
            &#39;NestedMessage&#39;: MessageType({
                &#39;NestedEnum&#39;: EnumType([(&#39;EPSILON&#39;, 5), (&#39;ZETA&#39;, 6)]),
                &#39;DeepNestedMessage&#39;: MessageType({
                    &#39;NestedEnum&#39;: EnumType([(&#39;ETA&#39;, 7), (&#39;THETA&#39;, 8)]),
                }, [
                    (&#39;nested_enum&#39;, EnumField(1, &#39;NestedEnum&#39;, &#39;ETA&#39;)),
                    (&#39;nested_field&#39;, StringField(2, &#39;theta&#39;)),
                ]),
            }, [
                (&#39;nested_enum&#39;, EnumField(1, &#39;NestedEnum&#39;, &#39;ZETA&#39;)),
                (&#39;nested_field&#39;, StringField(2, &#39;beta&#39;)),
                (&#39;deep_nested_message&#39;, MessageField(3, &#39;DeepNestedMessage&#39;)),
            ])
        }, [
            (&#39;nested_enum&#39;, EnumField(1, &#39;NestedEnum&#39;, &#39;BETA&#39;)),
            (&#39;nested_message&#39;, MessageField(2, &#39;NestedMessage&#39;)),
        ], is_extendable=True),

        &#39;DescriptorPoolTest2&#39;: MessageType({
            &#39;NestedEnum&#39;: EnumType([(&#39;GAMMA&#39;, 3), (&#39;DELTA&#39;, 4)]),
            &#39;NestedMessage&#39;: MessageType({
                &#39;NestedEnum&#39;: EnumType([(&#39;IOTA&#39;, 9), (&#39;KAPPA&#39;, 10)]),
                &#39;DeepNestedMessage&#39;: MessageType({
                    &#39;NestedEnum&#39;: EnumType([(&#39;LAMBDA&#39;, 11), (&#39;MU&#39;, 12)]),
                }, [
                    (&#39;nested_enum&#39;, EnumField(1, &#39;NestedEnum&#39;, &#39;MU&#39;)),
                    (&#39;nested_field&#39;, StringField(2, &#39;lambda&#39;)),
                ]),
            }, [
                (&#39;nested_enum&#39;, EnumField(1, &#39;NestedEnum&#39;, &#39;IOTA&#39;)),
                (&#39;nested_field&#39;, StringField(2, &#39;delta&#39;)),
                (&#39;deep_nested_message&#39;, MessageField(3, &#39;DeepNestedMessage&#39;)),
            ])
        }, [
            (&#39;nested_enum&#39;, EnumField(1, &#39;NestedEnum&#39;, &#39;GAMMA&#39;)),
            (&#39;nested_message&#39;, MessageField(2, &#39;NestedMessage&#39;)),
        ]),
    })


TEST2_FILE = ProtoFile(
    &#39;google/protobuf/internal/descriptor_pool_test2.proto&#39;,
    &#39;google.protobuf.python.internal&#39;,
    {
        &#39;DescriptorPoolTest3&#39;: MessageType({
            &#39;NestedEnum&#39;: EnumType([(&#39;NU&#39;, 13), (&#39;XI&#39;, 14)]),
            &#39;NestedMessage&#39;: MessageType({
                &#39;NestedEnum&#39;: EnumType([(&#39;OMICRON&#39;, 15), (&#39;PI&#39;, 16)]),
                &#39;DeepNestedMessage&#39;: MessageType({
                    &#39;NestedEnum&#39;: EnumType([(&#39;RHO&#39;, 17), (&#39;SIGMA&#39;, 18)]),
                }, [
                    (&#39;nested_enum&#39;, EnumField(1, &#39;NestedEnum&#39;, &#39;RHO&#39;)),
                    (&#39;nested_field&#39;, StringField(2, &#39;sigma&#39;)),
                ]),
            }, [
                (&#39;nested_enum&#39;, EnumField(1, &#39;NestedEnum&#39;, &#39;PI&#39;)),
                (&#39;nested_field&#39;, StringField(2, &#39;nu&#39;)),
                (&#39;deep_nested_message&#39;, MessageField(3, &#39;DeepNestedMessage&#39;)),
            ])
        }, [
            (&#39;nested_enum&#39;, EnumField(1, &#39;NestedEnum&#39;, &#39;XI&#39;)),
            (&#39;nested_message&#39;, MessageField(2, &#39;NestedMessage&#39;)),
        ], extensions=[
            (&#39;descriptor_pool_test&#39;,
             ExtensionField(1001, &#39;DescriptorPoolTest1&#39;)),
        ]),
    },
    dependencies=[&#39;google/protobuf/internal/descriptor_pool_test1.proto&#39;,
                  &#39;google/protobuf/internal/more_messages.proto&#39;],
    public_dependencies=[&#39;google/protobuf/internal/more_messages.proto&#39;])


if __name__ == &#39;__main__&#39;:
  unittest.main()</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="google.protobuf.internal.descriptor_pool_test.AddDescriptorTest"><code class="flex name class">
<span>class <span class="ident">AddDescriptorTest</span></span>
<span>(</span><span>methodName='runTest')</span>
</code></dt>
<dd>
<section class="desc"><p>A class whose instances are single test cases.</p>
<p>By default, the test code itself should be placed in a method named
'runTest'.</p>
<p>If the fixture may be used for many test cases, create as
many test methods as are needed. When instantiating such a TestCase
subclass, specify in the constructor arguments the name of the test method
that the instance is to execute.</p>
<p>Test authors should subclass TestCase for their own tests. Construction
and deconstruction of the test's environment ('fixture') can be
implemented by overriding the 'setUp' and 'tearDown' methods respectively.</p>
<p>If it is necessary to override the <strong>init</strong> method, the base class
<strong>init</strong> method must always be called. It is important that subclasses
should not change the signature of their <strong>init</strong> method, since instances
of the classes are instantiated automatically by parts of the framework
in order to be run.</p>
<p>When subclassing TestCase, you can set these attributes:
* failureException: determines which exception will be raised when
the instance's assertion methods fail; test methods raising this
exception will be deemed to have 'failed' rather than 'errored'.
* longMessage: determines whether long messages (including repr of
objects used in assert methods) will be printed on failure in <em>addition</em>
to any explicit message passed.
* maxDiff: sets the maximum length of a diff in failure messages
by assert methods using difflib. It is looked up as an instance
attribute so can be configured by individual tests if required.</p>
<p>Create an instance of the class that will use the named test
method when executed. Raises a ValueError if the instance does
not have a method with the specified name.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class AddDescriptorTest(unittest.TestCase):

  def _TestMessage(self, prefix):
    pool = descriptor_pool.DescriptorPool()
    pool.AddDescriptor(unittest_pb2.TestAllTypes.DESCRIPTOR)
    self.assertEqual(
        &#39;protobuf_unittest.TestAllTypes&#39;,
        pool.FindMessageTypeByName(
            prefix + &#39;protobuf_unittest.TestAllTypes&#39;).full_name)

    # AddDescriptor is not recursive.
    with self.assertRaises(KeyError):
      pool.FindMessageTypeByName(
          prefix + &#39;protobuf_unittest.TestAllTypes.NestedMessage&#39;)

    pool.AddDescriptor(unittest_pb2.TestAllTypes.NestedMessage.DESCRIPTOR)
    self.assertEqual(
        &#39;protobuf_unittest.TestAllTypes.NestedMessage&#39;,
        pool.FindMessageTypeByName(
            prefix + &#39;protobuf_unittest.TestAllTypes.NestedMessage&#39;).full_name)

    # Files are implicitly also indexed when messages are added.
    self.assertEqual(
        &#39;google/protobuf/unittest.proto&#39;,
        pool.FindFileByName(
            &#39;google/protobuf/unittest.proto&#39;).name)

    self.assertEqual(
        &#39;google/protobuf/unittest.proto&#39;,
        pool.FindFileContainingSymbol(
            prefix + &#39;protobuf_unittest.TestAllTypes.NestedMessage&#39;).name)

  @unittest.skipIf(api_implementation.Type() == &#39;cpp&#39;,
                   &#39;With the cpp implementation, Add() must be called first&#39;)
  def testMessage(self):
    self._TestMessage(&#39;&#39;)
    self._TestMessage(&#39;.&#39;)

  def _TestEnum(self, prefix):
    pool = descriptor_pool.DescriptorPool()
    pool.AddEnumDescriptor(unittest_pb2.ForeignEnum.DESCRIPTOR)
    self.assertEqual(
        &#39;protobuf_unittest.ForeignEnum&#39;,
        pool.FindEnumTypeByName(
            prefix + &#39;protobuf_unittest.ForeignEnum&#39;).full_name)

    # AddEnumDescriptor is not recursive.
    with self.assertRaises(KeyError):
      pool.FindEnumTypeByName(
          prefix + &#39;protobuf_unittest.ForeignEnum.NestedEnum&#39;)

    pool.AddEnumDescriptor(unittest_pb2.TestAllTypes.NestedEnum.DESCRIPTOR)
    self.assertEqual(
        &#39;protobuf_unittest.TestAllTypes.NestedEnum&#39;,
        pool.FindEnumTypeByName(
            prefix + &#39;protobuf_unittest.TestAllTypes.NestedEnum&#39;).full_name)

    # Files are implicitly also indexed when enums are added.
    self.assertEqual(
        &#39;google/protobuf/unittest.proto&#39;,
        pool.FindFileByName(
            &#39;google/protobuf/unittest.proto&#39;).name)

    self.assertEqual(
        &#39;google/protobuf/unittest.proto&#39;,
        pool.FindFileContainingSymbol(
            prefix + &#39;protobuf_unittest.TestAllTypes.NestedEnum&#39;).name)

  @unittest.skipIf(api_implementation.Type() == &#39;cpp&#39;,
                   &#39;With the cpp implementation, Add() must be called first&#39;)
  def testEnum(self):
    self._TestEnum(&#39;&#39;)
    self._TestEnum(&#39;.&#39;)

  @unittest.skipIf(api_implementation.Type() == &#39;cpp&#39;,
                   &#39;With the cpp implementation, Add() must be called first&#39;)
  def testService(self):
    pool = descriptor_pool.DescriptorPool()
    with self.assertRaises(KeyError):
      pool.FindServiceByName(&#39;protobuf_unittest.TestService&#39;)
    pool.AddServiceDescriptor(unittest_pb2._TESTSERVICE)
    self.assertEqual(
        &#39;protobuf_unittest.TestService&#39;,
        pool.FindServiceByName(&#39;protobuf_unittest.TestService&#39;).full_name)

  @unittest.skipIf(api_implementation.Type() == &#39;cpp&#39;,
                   &#39;With the cpp implementation, Add() must be called first&#39;)
  def testFile(self):
    pool = descriptor_pool.DescriptorPool()
    pool.AddFileDescriptor(unittest_pb2.DESCRIPTOR)
    self.assertEqual(
        &#39;google/protobuf/unittest.proto&#39;,
        pool.FindFileByName(
            &#39;google/protobuf/unittest.proto&#39;).name)

    # AddFileDescriptor is not recursive; messages and enums within files must
    # be explicitly registered.
    with self.assertRaises(KeyError):
      pool.FindFileContainingSymbol(
          &#39;protobuf_unittest.TestAllTypes&#39;)

  def testEmptyDescriptorPool(self):
    # Check that an empty DescriptorPool() contains no messages.
    pool = descriptor_pool.DescriptorPool()
    proto_file_name = descriptor_pb2.DESCRIPTOR.name
    self.assertRaises(KeyError, pool.FindFileByName, proto_file_name)
    # Add the above file to the pool
    file_descriptor = descriptor_pb2.FileDescriptorProto()
    descriptor_pb2.DESCRIPTOR.CopyToProto(file_descriptor)
    pool.Add(file_descriptor)
    # Now it exists.
    self.assertTrue(pool.FindFileByName(proto_file_name))

  def testCustomDescriptorPool(self):
    # Create a new pool, and add a file descriptor.
    pool = descriptor_pool.DescriptorPool()
    file_desc = descriptor_pb2.FileDescriptorProto(
        name=&#39;some/file.proto&#39;, package=&#39;package&#39;)
    file_desc.message_type.add(name=&#39;Message&#39;)
    pool.Add(file_desc)
    self.assertEqual(pool.FindFileByName(&#39;some/file.proto&#39;).name,
                     &#39;some/file.proto&#39;)
    self.assertEqual(pool.FindMessageTypeByName(&#39;package.Message&#39;).name,
                     &#39;Message&#39;)
    # Test no package
    file_proto = descriptor_pb2.FileDescriptorProto(
        name=&#39;some/filename/container.proto&#39;)
    message_proto = file_proto.message_type.add(
        name=&#39;TopMessage&#39;)
    message_proto.field.add(
        name=&#39;bb&#39;,
        number=1,
        type=descriptor_pb2.FieldDescriptorProto.TYPE_INT32,
        label=descriptor_pb2.FieldDescriptorProto.LABEL_OPTIONAL)
    enum_proto = file_proto.enum_type.add(name=&#39;TopEnum&#39;)
    enum_proto.value.add(name=&#39;FOREIGN_FOO&#39;, number=4)
    file_proto.service.add(name=&#39;TopService&#39;)
    pool = descriptor_pool.DescriptorPool()
    pool.Add(file_proto)
    self.assertEqual(&#39;TopMessage&#39;,
                     pool.FindMessageTypeByName(&#39;TopMessage&#39;).name)
    self.assertEqual(&#39;TopEnum&#39;, pool.FindEnumTypeByName(&#39;TopEnum&#39;).name)
    self.assertEqual(&#39;TopService&#39;, pool.FindServiceByName(&#39;TopService&#39;).name)

  def testFileDescriptorOptionsWithCustomDescriptorPool(self):
    # Create a descriptor pool, and add a new FileDescriptorProto to it.
    pool = descriptor_pool.DescriptorPool()
    file_name = &#39;file_descriptor_options_with_custom_descriptor_pool.proto&#39;
    file_descriptor_proto = descriptor_pb2.FileDescriptorProto(name=file_name)
    extension_id = file_options_test_pb2.foo_options
    file_descriptor_proto.options.Extensions[extension_id].foo_name = &#39;foo&#39;
    pool.Add(file_descriptor_proto)
    # The options set on the FileDescriptorProto should be available in the
    # descriptor even if they contain extensions that cannot be deserialized
    # using the pool.
    file_descriptor = pool.FindFileByName(file_name)
    options = file_descriptor.GetOptions()
    self.assertEqual(&#39;foo&#39;, options.Extensions[extension_id].foo_name)
    # The object returned by GetOptions() is cached.
    self.assertIs(options, file_descriptor.GetOptions())

  def testAddTypeError(self):
    pool = descriptor_pool.DescriptorPool()
    with self.assertRaises(TypeError):
      pool.AddDescriptor(0)
    with self.assertRaises(TypeError):
      pool.AddEnumDescriptor(0)
    with self.assertRaises(TypeError):
      pool.AddServiceDescriptor(0)
    with self.assertRaises(TypeError):
      pool.AddExtensionDescriptor(0)
    with self.assertRaises(TypeError):
      pool.AddFileDescriptor(0)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li>unittest.case.TestCase</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="google.protobuf.internal.descriptor_pool_test.AddDescriptorTest.testAddTypeError"><code class="name flex">
<span>def <span class="ident">testAddTypeError</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def testAddTypeError(self):
  pool = descriptor_pool.DescriptorPool()
  with self.assertRaises(TypeError):
    pool.AddDescriptor(0)
  with self.assertRaises(TypeError):
    pool.AddEnumDescriptor(0)
  with self.assertRaises(TypeError):
    pool.AddServiceDescriptor(0)
  with self.assertRaises(TypeError):
    pool.AddExtensionDescriptor(0)
  with self.assertRaises(TypeError):
    pool.AddFileDescriptor(0)</code></pre>
</details>
</dd>
<dt id="google.protobuf.internal.descriptor_pool_test.AddDescriptorTest.testCustomDescriptorPool"><code class="name flex">
<span>def <span class="ident">testCustomDescriptorPool</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def testCustomDescriptorPool(self):
  # Create a new pool, and add a file descriptor.
  pool = descriptor_pool.DescriptorPool()
  file_desc = descriptor_pb2.FileDescriptorProto(
      name=&#39;some/file.proto&#39;, package=&#39;package&#39;)
  file_desc.message_type.add(name=&#39;Message&#39;)
  pool.Add(file_desc)
  self.assertEqual(pool.FindFileByName(&#39;some/file.proto&#39;).name,
                   &#39;some/file.proto&#39;)
  self.assertEqual(pool.FindMessageTypeByName(&#39;package.Message&#39;).name,
                   &#39;Message&#39;)
  # Test no package
  file_proto = descriptor_pb2.FileDescriptorProto(
      name=&#39;some/filename/container.proto&#39;)
  message_proto = file_proto.message_type.add(
      name=&#39;TopMessage&#39;)
  message_proto.field.add(
      name=&#39;bb&#39;,
      number=1,
      type=descriptor_pb2.FieldDescriptorProto.TYPE_INT32,
      label=descriptor_pb2.FieldDescriptorProto.LABEL_OPTIONAL)
  enum_proto = file_proto.enum_type.add(name=&#39;TopEnum&#39;)
  enum_proto.value.add(name=&#39;FOREIGN_FOO&#39;, number=4)
  file_proto.service.add(name=&#39;TopService&#39;)
  pool = descriptor_pool.DescriptorPool()
  pool.Add(file_proto)
  self.assertEqual(&#39;TopMessage&#39;,
                   pool.FindMessageTypeByName(&#39;TopMessage&#39;).name)
  self.assertEqual(&#39;TopEnum&#39;, pool.FindEnumTypeByName(&#39;TopEnum&#39;).name)
  self.assertEqual(&#39;TopService&#39;, pool.FindServiceByName(&#39;TopService&#39;).name)</code></pre>
</details>
</dd>
<dt id="google.protobuf.internal.descriptor_pool_test.AddDescriptorTest.testEmptyDescriptorPool"><code class="name flex">
<span>def <span class="ident">testEmptyDescriptorPool</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def testEmptyDescriptorPool(self):
  # Check that an empty DescriptorPool() contains no messages.
  pool = descriptor_pool.DescriptorPool()
  proto_file_name = descriptor_pb2.DESCRIPTOR.name
  self.assertRaises(KeyError, pool.FindFileByName, proto_file_name)
  # Add the above file to the pool
  file_descriptor = descriptor_pb2.FileDescriptorProto()
  descriptor_pb2.DESCRIPTOR.CopyToProto(file_descriptor)
  pool.Add(file_descriptor)
  # Now it exists.
  self.assertTrue(pool.FindFileByName(proto_file_name))</code></pre>
</details>
</dd>
<dt id="google.protobuf.internal.descriptor_pool_test.AddDescriptorTest.testEnum"><code class="name flex">
<span>def <span class="ident">testEnum</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@unittest.skipIf(api_implementation.Type() == &#39;cpp&#39;,
                 &#39;With the cpp implementation, Add() must be called first&#39;)
def testEnum(self):
  self._TestEnum(&#39;&#39;)
  self._TestEnum(&#39;.&#39;)</code></pre>
</details>
</dd>
<dt id="google.protobuf.internal.descriptor_pool_test.AddDescriptorTest.testFile"><code class="name flex">
<span>def <span class="ident">testFile</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@unittest.skipIf(api_implementation.Type() == &#39;cpp&#39;,
                 &#39;With the cpp implementation, Add() must be called first&#39;)
def testFile(self):
  pool = descriptor_pool.DescriptorPool()
  pool.AddFileDescriptor(unittest_pb2.DESCRIPTOR)
  self.assertEqual(
      &#39;google/protobuf/unittest.proto&#39;,
      pool.FindFileByName(
          &#39;google/protobuf/unittest.proto&#39;).name)

  # AddFileDescriptor is not recursive; messages and enums within files must
  # be explicitly registered.
  with self.assertRaises(KeyError):
    pool.FindFileContainingSymbol(
        &#39;protobuf_unittest.TestAllTypes&#39;)</code></pre>
</details>
</dd>
<dt id="google.protobuf.internal.descriptor_pool_test.AddDescriptorTest.testFileDescriptorOptionsWithCustomDescriptorPool"><code class="name flex">
<span>def <span class="ident">testFileDescriptorOptionsWithCustomDescriptorPool</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def testFileDescriptorOptionsWithCustomDescriptorPool(self):
  # Create a descriptor pool, and add a new FileDescriptorProto to it.
  pool = descriptor_pool.DescriptorPool()
  file_name = &#39;file_descriptor_options_with_custom_descriptor_pool.proto&#39;
  file_descriptor_proto = descriptor_pb2.FileDescriptorProto(name=file_name)
  extension_id = file_options_test_pb2.foo_options
  file_descriptor_proto.options.Extensions[extension_id].foo_name = &#39;foo&#39;
  pool.Add(file_descriptor_proto)
  # The options set on the FileDescriptorProto should be available in the
  # descriptor even if they contain extensions that cannot be deserialized
  # using the pool.
  file_descriptor = pool.FindFileByName(file_name)
  options = file_descriptor.GetOptions()
  self.assertEqual(&#39;foo&#39;, options.Extensions[extension_id].foo_name)
  # The object returned by GetOptions() is cached.
  self.assertIs(options, file_descriptor.GetOptions())</code></pre>
</details>
</dd>
<dt id="google.protobuf.internal.descriptor_pool_test.AddDescriptorTest.testMessage"><code class="name flex">
<span>def <span class="ident">testMessage</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@unittest.skipIf(api_implementation.Type() == &#39;cpp&#39;,
                 &#39;With the cpp implementation, Add() must be called first&#39;)
def testMessage(self):
  self._TestMessage(&#39;&#39;)
  self._TestMessage(&#39;.&#39;)</code></pre>
</details>
</dd>
<dt id="google.protobuf.internal.descriptor_pool_test.AddDescriptorTest.testService"><code class="name flex">
<span>def <span class="ident">testService</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@unittest.skipIf(api_implementation.Type() == &#39;cpp&#39;,
                 &#39;With the cpp implementation, Add() must be called first&#39;)
def testService(self):
  pool = descriptor_pool.DescriptorPool()
  with self.assertRaises(KeyError):
    pool.FindServiceByName(&#39;protobuf_unittest.TestService&#39;)
  pool.AddServiceDescriptor(unittest_pb2._TESTSERVICE)
  self.assertEqual(
      &#39;protobuf_unittest.TestService&#39;,
      pool.FindServiceByName(&#39;protobuf_unittest.TestService&#39;).full_name)</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="google.protobuf.internal.descriptor_pool_test.CreateDescriptorPoolTest"><code class="flex name class">
<span>class <span class="ident">CreateDescriptorPoolTest</span></span>
<span>(</span><span>methodName='runTest')</span>
</code></dt>
<dd>
<section class="desc"><p>A class whose instances are single test cases.</p>
<p>By default, the test code itself should be placed in a method named
'runTest'.</p>
<p>If the fixture may be used for many test cases, create as
many test methods as are needed. When instantiating such a TestCase
subclass, specify in the constructor arguments the name of the test method
that the instance is to execute.</p>
<p>Test authors should subclass TestCase for their own tests. Construction
and deconstruction of the test's environment ('fixture') can be
implemented by overriding the 'setUp' and 'tearDown' methods respectively.</p>
<p>If it is necessary to override the <strong>init</strong> method, the base class
<strong>init</strong> method must always be called. It is important that subclasses
should not change the signature of their <strong>init</strong> method, since instances
of the classes are instantiated automatically by parts of the framework
in order to be run.</p>
<p>When subclassing TestCase, you can set these attributes:
* failureException: determines which exception will be raised when
the instance's assertion methods fail; test methods raising this
exception will be deemed to have 'failed' rather than 'errored'.
* longMessage: determines whether long messages (including repr of
objects used in assert methods) will be printed on failure in <em>addition</em>
to any explicit message passed.
* maxDiff: sets the maximum length of a diff in failure messages
by assert methods using difflib. It is looked up as an instance
attribute so can be configured by individual tests if required.</p>
<p>Create an instance of the class that will use the named test
method when executed. Raises a ValueError if the instance does
not have a method with the specified name.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class CreateDescriptorPoolTest(DescriptorPoolTestBase, unittest.TestCase):

  def setUp(self):
    self.pool = descriptor_pool.DescriptorPool()
    self.factory_test1_fd = descriptor_pb2.FileDescriptorProto.FromString(
        factory_test1_pb2.DESCRIPTOR.serialized_pb)
    self.factory_test2_fd = descriptor_pb2.FileDescriptorProto.FromString(
        factory_test2_pb2.DESCRIPTOR.serialized_pb)
    self.pool.Add(self.factory_test1_fd)
    self.pool.Add(self.factory_test2_fd)

    self.pool.Add(descriptor_pb2.FileDescriptorProto.FromString(
        unittest_import_public_pb2.DESCRIPTOR.serialized_pb))
    self.pool.Add(descriptor_pb2.FileDescriptorProto.FromString(
        unittest_import_pb2.DESCRIPTOR.serialized_pb))
    self.pool.Add(descriptor_pb2.FileDescriptorProto.FromString(
        unittest_pb2.DESCRIPTOR.serialized_pb))
    self.pool.Add(descriptor_pb2.FileDescriptorProto.FromString(
        no_package_pb2.DESCRIPTOR.serialized_pb))</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase" href="#google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase">DescriptorPoolTestBase</a></li>
<li>unittest.case.TestCase</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="google.protobuf.internal.descriptor_pool_test.CreateDescriptorPoolTest.setUp"><code class="name flex">
<span>def <span class="ident">setUp</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>Hook method for setting up the test fixture before exercising it.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def setUp(self):
  self.pool = descriptor_pool.DescriptorPool()
  self.factory_test1_fd = descriptor_pb2.FileDescriptorProto.FromString(
      factory_test1_pb2.DESCRIPTOR.serialized_pb)
  self.factory_test2_fd = descriptor_pb2.FileDescriptorProto.FromString(
      factory_test2_pb2.DESCRIPTOR.serialized_pb)
  self.pool.Add(self.factory_test1_fd)
  self.pool.Add(self.factory_test2_fd)

  self.pool.Add(descriptor_pb2.FileDescriptorProto.FromString(
      unittest_import_public_pb2.DESCRIPTOR.serialized_pb))
  self.pool.Add(descriptor_pb2.FileDescriptorProto.FromString(
      unittest_import_pb2.DESCRIPTOR.serialized_pb))
  self.pool.Add(descriptor_pb2.FileDescriptorProto.FromString(
      unittest_pb2.DESCRIPTOR.serialized_pb))
  self.pool.Add(descriptor_pb2.FileDescriptorProto.FromString(
      no_package_pb2.DESCRIPTOR.serialized_pb))</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase" href="#google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase">DescriptorPoolTestBase</a></b></code>:
<ul class="hlist">
<li><code><a title="google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testDefaultValueForCustomMessages" href="#google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testDefaultValueForCustomMessages">testDefaultValueForCustomMessages</a></code></li>
<li><code><a title="google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testEnumDefaultValue" href="#google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testEnumDefaultValue">testEnumDefaultValue</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="google.protobuf.internal.descriptor_pool_test.DefaultDescriptorPoolTest"><code class="flex name class">
<span>class <span class="ident">DefaultDescriptorPoolTest</span></span>
<span>(</span><span>methodName='runTest')</span>
</code></dt>
<dd>
<section class="desc"><p>A class whose instances are single test cases.</p>
<p>By default, the test code itself should be placed in a method named
'runTest'.</p>
<p>If the fixture may be used for many test cases, create as
many test methods as are needed. When instantiating such a TestCase
subclass, specify in the constructor arguments the name of the test method
that the instance is to execute.</p>
<p>Test authors should subclass TestCase for their own tests. Construction
and deconstruction of the test's environment ('fixture') can be
implemented by overriding the 'setUp' and 'tearDown' methods respectively.</p>
<p>If it is necessary to override the <strong>init</strong> method, the base class
<strong>init</strong> method must always be called. It is important that subclasses
should not change the signature of their <strong>init</strong> method, since instances
of the classes are instantiated automatically by parts of the framework
in order to be run.</p>
<p>When subclassing TestCase, you can set these attributes:
* failureException: determines which exception will be raised when
the instance's assertion methods fail; test methods raising this
exception will be deemed to have 'failed' rather than 'errored'.
* longMessage: determines whether long messages (including repr of
objects used in assert methods) will be printed on failure in <em>addition</em>
to any explicit message passed.
* maxDiff: sets the maximum length of a diff in failure messages
by assert methods using difflib. It is looked up as an instance
attribute so can be configured by individual tests if required.</p>
<p>Create an instance of the class that will use the named test
method when executed. Raises a ValueError if the instance does
not have a method with the specified name.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class DefaultDescriptorPoolTest(DescriptorPoolTestBase, unittest.TestCase):

  def setUp(self):
    self.pool = descriptor_pool.Default()
    self.factory_test1_fd = descriptor_pb2.FileDescriptorProto.FromString(
        factory_test1_pb2.DESCRIPTOR.serialized_pb)
    self.factory_test2_fd = descriptor_pb2.FileDescriptorProto.FromString(
        factory_test2_pb2.DESCRIPTOR.serialized_pb)

  def testFindMethods(self):
    self.assertIs(
        self.pool.FindFileByName(&#39;google/protobuf/unittest.proto&#39;),
        unittest_pb2.DESCRIPTOR)
    self.assertIs(
        self.pool.FindMessageTypeByName(&#39;protobuf_unittest.TestAllTypes&#39;),
        unittest_pb2.TestAllTypes.DESCRIPTOR)
    self.assertIs(
        self.pool.FindFieldByName(
            &#39;protobuf_unittest.TestAllTypes.optional_int32&#39;),
        unittest_pb2.TestAllTypes.DESCRIPTOR.fields_by_name[&#39;optional_int32&#39;])
    self.assertIs(
        self.pool.FindEnumTypeByName(&#39;protobuf_unittest.ForeignEnum&#39;),
        unittest_pb2.ForeignEnum.DESCRIPTOR)
    self.assertIs(
        self.pool.FindExtensionByName(
            &#39;protobuf_unittest.optional_int32_extension&#39;),
        unittest_pb2.DESCRIPTOR.extensions_by_name[&#39;optional_int32_extension&#39;])
    self.assertIs(
        self.pool.FindOneofByName(&#39;protobuf_unittest.TestAllTypes.oneof_field&#39;),
        unittest_pb2.TestAllTypes.DESCRIPTOR.oneofs_by_name[&#39;oneof_field&#39;])
    self.assertIs(
        self.pool.FindServiceByName(&#39;protobuf_unittest.TestService&#39;),
        unittest_pb2.DESCRIPTOR.services_by_name[&#39;TestService&#39;])</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase" href="#google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase">DescriptorPoolTestBase</a></li>
<li>unittest.case.TestCase</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="google.protobuf.internal.descriptor_pool_test.DefaultDescriptorPoolTest.setUp"><code class="name flex">
<span>def <span class="ident">setUp</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>Hook method for setting up the test fixture before exercising it.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def setUp(self):
  self.pool = descriptor_pool.Default()
  self.factory_test1_fd = descriptor_pb2.FileDescriptorProto.FromString(
      factory_test1_pb2.DESCRIPTOR.serialized_pb)
  self.factory_test2_fd = descriptor_pb2.FileDescriptorProto.FromString(
      factory_test2_pb2.DESCRIPTOR.serialized_pb)</code></pre>
</details>
</dd>
<dt id="google.protobuf.internal.descriptor_pool_test.DefaultDescriptorPoolTest.testFindMethods"><code class="name flex">
<span>def <span class="ident">testFindMethods</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def testFindMethods(self):
  self.assertIs(
      self.pool.FindFileByName(&#39;google/protobuf/unittest.proto&#39;),
      unittest_pb2.DESCRIPTOR)
  self.assertIs(
      self.pool.FindMessageTypeByName(&#39;protobuf_unittest.TestAllTypes&#39;),
      unittest_pb2.TestAllTypes.DESCRIPTOR)
  self.assertIs(
      self.pool.FindFieldByName(
          &#39;protobuf_unittest.TestAllTypes.optional_int32&#39;),
      unittest_pb2.TestAllTypes.DESCRIPTOR.fields_by_name[&#39;optional_int32&#39;])
  self.assertIs(
      self.pool.FindEnumTypeByName(&#39;protobuf_unittest.ForeignEnum&#39;),
      unittest_pb2.ForeignEnum.DESCRIPTOR)
  self.assertIs(
      self.pool.FindExtensionByName(
          &#39;protobuf_unittest.optional_int32_extension&#39;),
      unittest_pb2.DESCRIPTOR.extensions_by_name[&#39;optional_int32_extension&#39;])
  self.assertIs(
      self.pool.FindOneofByName(&#39;protobuf_unittest.TestAllTypes.oneof_field&#39;),
      unittest_pb2.TestAllTypes.DESCRIPTOR.oneofs_by_name[&#39;oneof_field&#39;])
  self.assertIs(
      self.pool.FindServiceByName(&#39;protobuf_unittest.TestService&#39;),
      unittest_pb2.DESCRIPTOR.services_by_name[&#39;TestService&#39;])</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase" href="#google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase">DescriptorPoolTestBase</a></b></code>:
<ul class="hlist">
<li><code><a title="google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testDefaultValueForCustomMessages" href="#google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testDefaultValueForCustomMessages">testDefaultValueForCustomMessages</a></code></li>
<li><code><a title="google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testEnumDefaultValue" href="#google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testEnumDefaultValue">testEnumDefaultValue</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase"><code class="flex name class">
<span>class <span class="ident">DescriptorPoolTestBase</span></span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class DescriptorPoolTestBase(object):

  def testFindFileByName(self):
    name1 = &#39;google/protobuf/internal/factory_test1.proto&#39;
    file_desc1 = self.pool.FindFileByName(name1)
    self.assertIsInstance(file_desc1, descriptor.FileDescriptor)
    self.assertEqual(name1, file_desc1.name)
    self.assertEqual(&#39;google.protobuf.python.internal&#39;, file_desc1.package)
    self.assertIn(&#39;Factory1Message&#39;, file_desc1.message_types_by_name)

    name2 = &#39;google/protobuf/internal/factory_test2.proto&#39;
    file_desc2 = self.pool.FindFileByName(name2)
    self.assertIsInstance(file_desc2, descriptor.FileDescriptor)
    self.assertEqual(name2, file_desc2.name)
    self.assertEqual(&#39;google.protobuf.python.internal&#39;, file_desc2.package)
    self.assertIn(&#39;Factory2Message&#39;, file_desc2.message_types_by_name)

  def testFindFileByNameFailure(self):
    with self.assertRaises(KeyError):
      self.pool.FindFileByName(&#39;Does not exist&#39;)

  def testFindFileContainingSymbol(self):
    file_desc1 = self.pool.FindFileContainingSymbol(
        &#39;google.protobuf.python.internal.Factory1Message&#39;)
    self.assertIsInstance(file_desc1, descriptor.FileDescriptor)
    self.assertEqual(&#39;google/protobuf/internal/factory_test1.proto&#39;,
                     file_desc1.name)
    self.assertEqual(&#39;google.protobuf.python.internal&#39;, file_desc1.package)
    self.assertIn(&#39;Factory1Message&#39;, file_desc1.message_types_by_name)

    file_desc2 = self.pool.FindFileContainingSymbol(
        &#39;google.protobuf.python.internal.Factory2Message&#39;)
    self.assertIsInstance(file_desc2, descriptor.FileDescriptor)
    self.assertEqual(&#39;google/protobuf/internal/factory_test2.proto&#39;,
                     file_desc2.name)
    self.assertEqual(&#39;google.protobuf.python.internal&#39;, file_desc2.package)
    self.assertIn(&#39;Factory2Message&#39;, file_desc2.message_types_by_name)

    # Tests top level extension.
    file_desc3 = self.pool.FindFileContainingSymbol(
        &#39;google.protobuf.python.internal.another_field&#39;)
    self.assertIsInstance(file_desc3, descriptor.FileDescriptor)
    self.assertEqual(&#39;google/protobuf/internal/factory_test2.proto&#39;,
                     file_desc3.name)

    # Tests nested extension inside a message.
    file_desc4 = self.pool.FindFileContainingSymbol(
        &#39;google.protobuf.python.internal.Factory2Message.one_more_field&#39;)
    self.assertIsInstance(file_desc4, descriptor.FileDescriptor)
    self.assertEqual(&#39;google/protobuf/internal/factory_test2.proto&#39;,
                     file_desc4.name)

    file_desc5 = self.pool.FindFileContainingSymbol(
        &#39;protobuf_unittest.TestService&#39;)
    self.assertIsInstance(file_desc5, descriptor.FileDescriptor)
    self.assertEqual(&#39;google/protobuf/unittest.proto&#39;,
                     file_desc5.name)
    # Tests the generated pool.
    assert descriptor_pool.Default().FindFileContainingSymbol(
        &#39;google.protobuf.python.internal.Factory2Message.one_more_field&#39;)
    assert descriptor_pool.Default().FindFileContainingSymbol(
        &#39;google.protobuf.python.internal.another_field&#39;)
    assert descriptor_pool.Default().FindFileContainingSymbol(
        &#39;protobuf_unittest.TestService&#39;)

    # Can find field.
    file_desc6 = self.pool.FindFileContainingSymbol(
        &#39;google.protobuf.python.internal.Factory1Message.list_value&#39;)
    self.assertIsInstance(file_desc6, descriptor.FileDescriptor)
    self.assertEqual(&#39;google/protobuf/internal/factory_test1.proto&#39;,
                     file_desc6.name)

    # Can find top level Enum value.
    file_desc7 = self.pool.FindFileContainingSymbol(
        &#39;google.protobuf.python.internal.FACTORY_1_VALUE_0&#39;)
    self.assertIsInstance(file_desc7, descriptor.FileDescriptor)
    self.assertEqual(&#39;google/protobuf/internal/factory_test1.proto&#39;,
                     file_desc7.name)

    # Can find nested Enum value.
    file_desc8 = self.pool.FindFileContainingSymbol(
        &#39;protobuf_unittest.TestAllTypes.FOO&#39;)
    self.assertIsInstance(file_desc8, descriptor.FileDescriptor)
    self.assertEqual(&#39;google/protobuf/unittest.proto&#39;,
                     file_desc8.name)

    # TODO(jieluo): Add tests for no package when b/13860351 is fixed.

    self.assertRaises(KeyError, self.pool.FindFileContainingSymbol,
                      &#39;google.protobuf.python.internal.Factory1Message.none_field&#39;)

  def testFindFileContainingSymbolFailure(self):
    with self.assertRaises(KeyError):
      self.pool.FindFileContainingSymbol(&#39;Does not exist&#39;)

  def testFindMessageTypeByName(self):
    msg1 = self.pool.FindMessageTypeByName(
        &#39;google.protobuf.python.internal.Factory1Message&#39;)
    self.assertIsInstance(msg1, descriptor.Descriptor)
    self.assertEqual(&#39;Factory1Message&#39;, msg1.name)
    self.assertEqual(&#39;google.protobuf.python.internal.Factory1Message&#39;,
                     msg1.full_name)
    self.assertEqual(None, msg1.containing_type)
    self.assertFalse(msg1.has_options)

    nested_msg1 = msg1.nested_types[0]
    self.assertEqual(&#39;NestedFactory1Message&#39;, nested_msg1.name)
    self.assertEqual(msg1, nested_msg1.containing_type)

    nested_enum1 = msg1.enum_types[0]
    self.assertEqual(&#39;NestedFactory1Enum&#39;, nested_enum1.name)
    self.assertEqual(msg1, nested_enum1.containing_type)

    self.assertEqual(nested_msg1, msg1.fields_by_name[
        &#39;nested_factory_1_message&#39;].message_type)
    self.assertEqual(nested_enum1, msg1.fields_by_name[
        &#39;nested_factory_1_enum&#39;].enum_type)

    msg2 = self.pool.FindMessageTypeByName(
        &#39;google.protobuf.python.internal.Factory2Message&#39;)
    self.assertIsInstance(msg2, descriptor.Descriptor)
    self.assertEqual(&#39;Factory2Message&#39;, msg2.name)
    self.assertEqual(&#39;google.protobuf.python.internal.Factory2Message&#39;,
                     msg2.full_name)
    self.assertIsNone(msg2.containing_type)

    nested_msg2 = msg2.nested_types[0]
    self.assertEqual(&#39;NestedFactory2Message&#39;, nested_msg2.name)
    self.assertEqual(msg2, nested_msg2.containing_type)

    nested_enum2 = msg2.enum_types[0]
    self.assertEqual(&#39;NestedFactory2Enum&#39;, nested_enum2.name)
    self.assertEqual(msg2, nested_enum2.containing_type)

    self.assertEqual(nested_msg2, msg2.fields_by_name[
        &#39;nested_factory_2_message&#39;].message_type)
    self.assertEqual(nested_enum2, msg2.fields_by_name[
        &#39;nested_factory_2_enum&#39;].enum_type)

    self.assertTrue(msg2.fields_by_name[&#39;int_with_default&#39;].has_default_value)
    self.assertEqual(
        1776, msg2.fields_by_name[&#39;int_with_default&#39;].default_value)

    self.assertTrue(
        msg2.fields_by_name[&#39;double_with_default&#39;].has_default_value)
    self.assertEqual(
        9.99, msg2.fields_by_name[&#39;double_with_default&#39;].default_value)

    self.assertTrue(
        msg2.fields_by_name[&#39;string_with_default&#39;].has_default_value)
    self.assertEqual(
        &#39;hello world&#39;, msg2.fields_by_name[&#39;string_with_default&#39;].default_value)

    self.assertTrue(msg2.fields_by_name[&#39;bool_with_default&#39;].has_default_value)
    self.assertFalse(msg2.fields_by_name[&#39;bool_with_default&#39;].default_value)

    self.assertTrue(msg2.fields_by_name[&#39;enum_with_default&#39;].has_default_value)
    self.assertEqual(
        1, msg2.fields_by_name[&#39;enum_with_default&#39;].default_value)

    msg3 = self.pool.FindMessageTypeByName(
        &#39;google.protobuf.python.internal.Factory2Message.NestedFactory2Message&#39;)
    self.assertEqual(nested_msg2, msg3)

    self.assertTrue(msg2.fields_by_name[&#39;bytes_with_default&#39;].has_default_value)
    self.assertEqual(
        b&#39;a\xfb\x00c&#39;,
        msg2.fields_by_name[&#39;bytes_with_default&#39;].default_value)

    self.assertEqual(1, len(msg2.oneofs))
    self.assertEqual(1, len(msg2.oneofs_by_name))
    self.assertEqual(2, len(msg2.oneofs[0].fields))
    for name in [&#39;oneof_int&#39;, &#39;oneof_string&#39;]:
      self.assertEqual(msg2.oneofs[0],
                       msg2.fields_by_name[name].containing_oneof)
      self.assertIn(msg2.fields_by_name[name], msg2.oneofs[0].fields)

  def testFindTypeErrors(self):
    self.assertRaises(TypeError, self.pool.FindExtensionByNumber, &#39;&#39;)
    self.assertRaises(KeyError, self.pool.FindMethodByName, &#39;&#39;)

    # TODO(jieluo): Fix python to raise correct errors.
    if api_implementation.Type() == &#39;cpp&#39;:
      error_type = TypeError
    else:
      error_type = AttributeError
    self.assertRaises(error_type, self.pool.FindMessageTypeByName, 0)
    self.assertRaises(error_type, self.pool.FindFieldByName, 0)
    self.assertRaises(error_type, self.pool.FindExtensionByName, 0)
    self.assertRaises(error_type, self.pool.FindEnumTypeByName, 0)
    self.assertRaises(error_type, self.pool.FindOneofByName, 0)
    self.assertRaises(error_type, self.pool.FindServiceByName, 0)
    self.assertRaises(error_type, self.pool.FindMethodByName, 0)
    self.assertRaises(error_type, self.pool.FindFileContainingSymbol, 0)
    if api_implementation.Type() == &#39;python&#39;:
      error_type = KeyError
    self.assertRaises(error_type, self.pool.FindFileByName, 0)

  def testFindMessageTypeByNameFailure(self):
    with self.assertRaises(KeyError):
      self.pool.FindMessageTypeByName(&#39;Does not exist&#39;)

  def testFindEnumTypeByName(self):
    enum1 = self.pool.FindEnumTypeByName(
        &#39;google.protobuf.python.internal.Factory1Enum&#39;)
    self.assertIsInstance(enum1, descriptor.EnumDescriptor)
    self.assertEqual(0, enum1.values_by_name[&#39;FACTORY_1_VALUE_0&#39;].number)
    self.assertEqual(1, enum1.values_by_name[&#39;FACTORY_1_VALUE_1&#39;].number)
    self.assertFalse(enum1.has_options)

    nested_enum1 = self.pool.FindEnumTypeByName(
        &#39;google.protobuf.python.internal.Factory1Message.NestedFactory1Enum&#39;)
    self.assertIsInstance(nested_enum1, descriptor.EnumDescriptor)
    self.assertEqual(
        0, nested_enum1.values_by_name[&#39;NESTED_FACTORY_1_VALUE_0&#39;].number)
    self.assertEqual(
        1, nested_enum1.values_by_name[&#39;NESTED_FACTORY_1_VALUE_1&#39;].number)

    enum2 = self.pool.FindEnumTypeByName(
        &#39;google.protobuf.python.internal.Factory2Enum&#39;)
    self.assertIsInstance(enum2, descriptor.EnumDescriptor)
    self.assertEqual(0, enum2.values_by_name[&#39;FACTORY_2_VALUE_0&#39;].number)
    self.assertEqual(1, enum2.values_by_name[&#39;FACTORY_2_VALUE_1&#39;].number)

    nested_enum2 = self.pool.FindEnumTypeByName(
        &#39;google.protobuf.python.internal.Factory2Message.NestedFactory2Enum&#39;)
    self.assertIsInstance(nested_enum2, descriptor.EnumDescriptor)
    self.assertEqual(
        0, nested_enum2.values_by_name[&#39;NESTED_FACTORY_2_VALUE_0&#39;].number)
    self.assertEqual(
        1, nested_enum2.values_by_name[&#39;NESTED_FACTORY_2_VALUE_1&#39;].number)

  def testFindEnumTypeByNameFailure(self):
    with self.assertRaises(KeyError):
      self.pool.FindEnumTypeByName(&#39;Does not exist&#39;)

  def testFindFieldByName(self):
    field = self.pool.FindFieldByName(
        &#39;google.protobuf.python.internal.Factory1Message.list_value&#39;)
    self.assertEqual(field.name, &#39;list_value&#39;)
    self.assertEqual(field.label, field.LABEL_REPEATED)
    self.assertFalse(field.has_options)

    with self.assertRaises(KeyError):
      self.pool.FindFieldByName(&#39;Does not exist&#39;)

  def testFindOneofByName(self):
    oneof = self.pool.FindOneofByName(
        &#39;google.protobuf.python.internal.Factory2Message.oneof_field&#39;)
    self.assertEqual(oneof.name, &#39;oneof_field&#39;)
    with self.assertRaises(KeyError):
      self.pool.FindOneofByName(&#39;Does not exist&#39;)

  def testFindExtensionByName(self):
    # An extension defined in a message.
    extension = self.pool.FindExtensionByName(
        &#39;google.protobuf.python.internal.Factory2Message.one_more_field&#39;)
    self.assertEqual(extension.name, &#39;one_more_field&#39;)
    # An extension defined at file scope.
    extension = self.pool.FindExtensionByName(
        &#39;google.protobuf.python.internal.another_field&#39;)
    self.assertEqual(extension.name, &#39;another_field&#39;)
    self.assertEqual(extension.number, 1002)
    with self.assertRaises(KeyError):
      self.pool.FindFieldByName(&#39;Does not exist&#39;)

  def testFindAllExtensions(self):
    factory1_message = self.pool.FindMessageTypeByName(
        &#39;google.protobuf.python.internal.Factory1Message&#39;)
    factory2_message = self.pool.FindMessageTypeByName(
        &#39;google.protobuf.python.internal.Factory2Message&#39;)
    # An extension defined in a message.
    one_more_field = factory2_message.extensions_by_name[&#39;one_more_field&#39;]
    self.pool.AddExtensionDescriptor(one_more_field)
    # An extension defined at file scope.
    factory_test2 = self.pool.FindFileByName(
        &#39;google/protobuf/internal/factory_test2.proto&#39;)
    another_field = factory_test2.extensions_by_name[&#39;another_field&#39;]
    self.pool.AddExtensionDescriptor(another_field)

    extensions = self.pool.FindAllExtensions(factory1_message)
    expected_extension_numbers = set([one_more_field, another_field])
    self.assertEqual(expected_extension_numbers, set(extensions))
    # Verify that mutating the returned list does not affect the pool.
    extensions.append(&#39;unexpected_element&#39;)
    # Get the extensions again, the returned value does not contain the
    # &#39;unexpected_element&#39;.
    extensions = self.pool.FindAllExtensions(factory1_message)
    self.assertEqual(expected_extension_numbers, set(extensions))

  def testFindExtensionByNumber(self):
    factory1_message = self.pool.FindMessageTypeByName(
        &#39;google.protobuf.python.internal.Factory1Message&#39;)
    factory2_message = self.pool.FindMessageTypeByName(
        &#39;google.protobuf.python.internal.Factory2Message&#39;)
    # An extension defined in a message.
    one_more_field = factory2_message.extensions_by_name[&#39;one_more_field&#39;]
    self.pool.AddExtensionDescriptor(one_more_field)
    # An extension defined at file scope.
    factory_test2 = self.pool.FindFileByName(
        &#39;google/protobuf/internal/factory_test2.proto&#39;)
    another_field = factory_test2.extensions_by_name[&#39;another_field&#39;]
    self.pool.AddExtensionDescriptor(another_field)

    # An extension defined in a message.
    extension = self.pool.FindExtensionByNumber(factory1_message, 1001)
    self.assertEqual(extension.name, &#39;one_more_field&#39;)
    # An extension defined at file scope.
    extension = self.pool.FindExtensionByNumber(factory1_message, 1002)
    self.assertEqual(extension.name, &#39;another_field&#39;)
    with self.assertRaises(KeyError):
      extension = self.pool.FindExtensionByNumber(factory1_message, 1234567)

  def testExtensionsAreNotFields(self):
    with self.assertRaises(KeyError):
      self.pool.FindFieldByName(&#39;google.protobuf.python.internal.another_field&#39;)
    with self.assertRaises(KeyError):
      self.pool.FindFieldByName(
          &#39;google.protobuf.python.internal.Factory2Message.one_more_field&#39;)
    with self.assertRaises(KeyError):
      self.pool.FindExtensionByName(
          &#39;google.protobuf.python.internal.Factory1Message.list_value&#39;)

  def testFindService(self):
    service = self.pool.FindServiceByName(&#39;protobuf_unittest.TestService&#39;)
    self.assertEqual(service.full_name, &#39;protobuf_unittest.TestService&#39;)
    with self.assertRaises(KeyError):
      self.pool.FindServiceByName(&#39;Does not exist&#39;)

    method = self.pool.FindMethodByName(&#39;protobuf_unittest.TestService.Foo&#39;)
    self.assertIs(method.containing_service, service)
    with self.assertRaises(KeyError):
      self.pool.FindMethodByName(&#39;protobuf_unittest.TestService.Doesnotexist&#39;)

  def testUserDefinedDB(self):
    db = descriptor_database.DescriptorDatabase()
    self.pool = descriptor_pool.DescriptorPool(db)
    db.Add(self.factory_test1_fd)
    db.Add(self.factory_test2_fd)
    self.testFindMessageTypeByName()

  def testAddSerializedFile(self):
    if isinstance(self, SecondaryDescriptorFromDescriptorDB):
      if api_implementation.Type() == &#39;cpp&#39;:
        # Cpp extension cannot call Add on a DescriptorPool
        # that uses a DescriptorDatabase.
        # TODO(jieluo): Fix python and cpp extension diff.
        return
    self.pool = descriptor_pool.DescriptorPool()
    self.pool.AddSerializedFile(self.factory_test1_fd.SerializeToString())
    self.pool.AddSerializedFile(self.factory_test2_fd.SerializeToString())
    self.testFindMessageTypeByName()


  def testEnumDefaultValue(self):
    &#34;&#34;&#34;Test the default value of enums which don&#39;t start at zero.&#34;&#34;&#34;
    def _CheckDefaultValue(file_descriptor):
      default_value = (file_descriptor
                       .message_types_by_name[&#39;DescriptorPoolTest1&#39;]
                       .fields_by_name[&#39;nested_enum&#39;]
                       .default_value)
      self.assertEqual(default_value,
                       descriptor_pool_test1_pb2.DescriptorPoolTest1.BETA)
    # First check what the generated descriptor contains.
    _CheckDefaultValue(descriptor_pool_test1_pb2.DESCRIPTOR)
    # Then check the generated pool. Normally this is the same descriptor.
    file_descriptor = symbol_database.Default().pool.FindFileByName(
        &#39;google/protobuf/internal/descriptor_pool_test1.proto&#39;)
    self.assertIs(file_descriptor, descriptor_pool_test1_pb2.DESCRIPTOR)
    _CheckDefaultValue(file_descriptor)

    if isinstance(self, SecondaryDescriptorFromDescriptorDB):
      if api_implementation.Type() == &#39;cpp&#39;:
        # Cpp extension cannot call Add on a DescriptorPool
        # that uses a DescriptorDatabase.
        # TODO(jieluo): Fix python and cpp extension diff.
        return
    # Then check the dynamic pool and its internal DescriptorDatabase.
    descriptor_proto = descriptor_pb2.FileDescriptorProto.FromString(
        descriptor_pool_test1_pb2.DESCRIPTOR.serialized_pb)
    self.pool.Add(descriptor_proto)
    # And do the same check as above
    file_descriptor = self.pool.FindFileByName(
        &#39;google/protobuf/internal/descriptor_pool_test1.proto&#39;)
    _CheckDefaultValue(file_descriptor)

  def testDefaultValueForCustomMessages(self):
    &#34;&#34;&#34;Check the value returned by non-existent fields.&#34;&#34;&#34;
    def _CheckValueAndType(value, expected_value, expected_type):
      self.assertEqual(value, expected_value)
      self.assertIsInstance(value, expected_type)

    def _CheckDefaultValues(msg):
      try:
        int64 = long
      except NameError:  # Python3
        int64 = int
      try:
        unicode_type = unicode
      except NameError:  # Python3
        unicode_type = str
      _CheckValueAndType(msg.optional_int32, 0, int)
      _CheckValueAndType(msg.optional_uint64, 0, (int64, int))
      _CheckValueAndType(msg.optional_float, 0, (float, int))
      _CheckValueAndType(msg.optional_double, 0, (float, int))
      _CheckValueAndType(msg.optional_bool, False, bool)
      _CheckValueAndType(msg.optional_string, u&#39;&#39;, unicode_type)
      _CheckValueAndType(msg.optional_bytes, b&#39;&#39;, bytes)
      _CheckValueAndType(msg.optional_nested_enum, msg.FOO, int)
    # First for the generated message
    _CheckDefaultValues(unittest_pb2.TestAllTypes())
    # Then for a message built with from the DescriptorPool.
    pool = descriptor_pool.DescriptorPool()
    pool.Add(descriptor_pb2.FileDescriptorProto.FromString(
        unittest_import_public_pb2.DESCRIPTOR.serialized_pb))
    pool.Add(descriptor_pb2.FileDescriptorProto.FromString(
        unittest_import_pb2.DESCRIPTOR.serialized_pb))
    pool.Add(descriptor_pb2.FileDescriptorProto.FromString(
        unittest_pb2.DESCRIPTOR.serialized_pb))
    message_class = message_factory.MessageFactory(pool).GetPrototype(
        pool.FindMessageTypeByName(
            unittest_pb2.TestAllTypes.DESCRIPTOR.full_name))
    _CheckDefaultValues(message_class())

  def testAddFileDescriptor(self):
    if isinstance(self, SecondaryDescriptorFromDescriptorDB):
      if api_implementation.Type() == &#39;cpp&#39;:
        # Cpp extension cannot call Add on a DescriptorPool
        # that uses a DescriptorDatabase.
        # TODO(jieluo): Fix python and cpp extension diff.
        return
    file_desc = descriptor_pb2.FileDescriptorProto(name=&#39;some/file.proto&#39;)
    self.pool.Add(file_desc)
    self.pool.AddSerializedFile(file_desc.SerializeToString())

  def testComplexNesting(self):
    if isinstance(self, SecondaryDescriptorFromDescriptorDB):
      if api_implementation.Type() == &#39;cpp&#39;:
        # Cpp extension cannot call Add on a DescriptorPool
        # that uses a DescriptorDatabase.
        # TODO(jieluo): Fix python and cpp extension diff.
        return
    more_messages_desc = descriptor_pb2.FileDescriptorProto.FromString(
        more_messages_pb2.DESCRIPTOR.serialized_pb)
    test1_desc = descriptor_pb2.FileDescriptorProto.FromString(
        descriptor_pool_test1_pb2.DESCRIPTOR.serialized_pb)
    test2_desc = descriptor_pb2.FileDescriptorProto.FromString(
        descriptor_pool_test2_pb2.DESCRIPTOR.serialized_pb)
    self.pool.Add(more_messages_desc)
    self.pool.Add(test1_desc)
    self.pool.Add(test2_desc)
    TEST1_FILE.CheckFile(self, self.pool)
    TEST2_FILE.CheckFile(self, self.pool)

  def testConflictRegister(self):
    if isinstance(self, SecondaryDescriptorFromDescriptorDB):
      if api_implementation.Type() == &#39;cpp&#39;:
        # Cpp extension cannot call Add on a DescriptorPool
        # that uses a DescriptorDatabase.
        # TODO(jieluo): Fix python and cpp extension diff.
        return
    unittest_fd = descriptor_pb2.FileDescriptorProto.FromString(
        unittest_pb2.DESCRIPTOR.serialized_pb)
    conflict_fd = copy.deepcopy(unittest_fd)
    conflict_fd.name = &#39;other_file&#39;
    if api_implementation.Type() == &#39;cpp&#39;:
        pass
    else:
      pool = copy.deepcopy(self.pool)
      file_descriptor = unittest_pb2.DESCRIPTOR
      pool.AddDescriptor(
          file_descriptor.message_types_by_name[&#39;TestAllTypes&#39;])
      pool.AddEnumDescriptor(
          file_descriptor.enum_types_by_name[&#39;ForeignEnum&#39;])
      pool.AddServiceDescriptor(
          file_descriptor.services_by_name[&#39;TestService&#39;])
      pool.AddExtensionDescriptor(
          file_descriptor.extensions_by_name[&#39;optional_int32_extension&#39;])
      pool.Add(unittest_fd)
      pool.Add(conflict_fd)
      pool.FindFileByName(unittest_fd.name)
      with self.assertRaises(TypeError):
        pool.FindFileByName(conflict_fd.name)</code></pre>
</details>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="google.protobuf.internal.descriptor_pool_test.CreateDescriptorPoolTest" href="#google.protobuf.internal.descriptor_pool_test.CreateDescriptorPoolTest">CreateDescriptorPoolTest</a></li>
<li><a title="google.protobuf.internal.descriptor_pool_test.DefaultDescriptorPoolTest" href="#google.protobuf.internal.descriptor_pool_test.DefaultDescriptorPoolTest">DefaultDescriptorPoolTest</a></li>
<li><a title="google.protobuf.internal.descriptor_pool_test.SecondaryDescriptorFromDescriptorDB" href="#google.protobuf.internal.descriptor_pool_test.SecondaryDescriptorFromDescriptorDB">SecondaryDescriptorFromDescriptorDB</a></li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testAddFileDescriptor"><code class="name flex">
<span>def <span class="ident">testAddFileDescriptor</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def testAddFileDescriptor(self):
  if isinstance(self, SecondaryDescriptorFromDescriptorDB):
    if api_implementation.Type() == &#39;cpp&#39;:
      # Cpp extension cannot call Add on a DescriptorPool
      # that uses a DescriptorDatabase.
      # TODO(jieluo): Fix python and cpp extension diff.
      return
  file_desc = descriptor_pb2.FileDescriptorProto(name=&#39;some/file.proto&#39;)
  self.pool.Add(file_desc)
  self.pool.AddSerializedFile(file_desc.SerializeToString())</code></pre>
</details>
</dd>
<dt id="google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testAddSerializedFile"><code class="name flex">
<span>def <span class="ident">testAddSerializedFile</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def testAddSerializedFile(self):
  if isinstance(self, SecondaryDescriptorFromDescriptorDB):
    if api_implementation.Type() == &#39;cpp&#39;:
      # Cpp extension cannot call Add on a DescriptorPool
      # that uses a DescriptorDatabase.
      # TODO(jieluo): Fix python and cpp extension diff.
      return
  self.pool = descriptor_pool.DescriptorPool()
  self.pool.AddSerializedFile(self.factory_test1_fd.SerializeToString())
  self.pool.AddSerializedFile(self.factory_test2_fd.SerializeToString())
  self.testFindMessageTypeByName()</code></pre>
</details>
</dd>
<dt id="google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testComplexNesting"><code class="name flex">
<span>def <span class="ident">testComplexNesting</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def testComplexNesting(self):
  if isinstance(self, SecondaryDescriptorFromDescriptorDB):
    if api_implementation.Type() == &#39;cpp&#39;:
      # Cpp extension cannot call Add on a DescriptorPool
      # that uses a DescriptorDatabase.
      # TODO(jieluo): Fix python and cpp extension diff.
      return
  more_messages_desc = descriptor_pb2.FileDescriptorProto.FromString(
      more_messages_pb2.DESCRIPTOR.serialized_pb)
  test1_desc = descriptor_pb2.FileDescriptorProto.FromString(
      descriptor_pool_test1_pb2.DESCRIPTOR.serialized_pb)
  test2_desc = descriptor_pb2.FileDescriptorProto.FromString(
      descriptor_pool_test2_pb2.DESCRIPTOR.serialized_pb)
  self.pool.Add(more_messages_desc)
  self.pool.Add(test1_desc)
  self.pool.Add(test2_desc)
  TEST1_FILE.CheckFile(self, self.pool)
  TEST2_FILE.CheckFile(self, self.pool)</code></pre>
</details>
</dd>
<dt id="google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testConflictRegister"><code class="name flex">
<span>def <span class="ident">testConflictRegister</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def testConflictRegister(self):
  if isinstance(self, SecondaryDescriptorFromDescriptorDB):
    if api_implementation.Type() == &#39;cpp&#39;:
      # Cpp extension cannot call Add on a DescriptorPool
      # that uses a DescriptorDatabase.
      # TODO(jieluo): Fix python and cpp extension diff.
      return
  unittest_fd = descriptor_pb2.FileDescriptorProto.FromString(
      unittest_pb2.DESCRIPTOR.serialized_pb)
  conflict_fd = copy.deepcopy(unittest_fd)
  conflict_fd.name = &#39;other_file&#39;
  if api_implementation.Type() == &#39;cpp&#39;:
      pass
  else:
    pool = copy.deepcopy(self.pool)
    file_descriptor = unittest_pb2.DESCRIPTOR
    pool.AddDescriptor(
        file_descriptor.message_types_by_name[&#39;TestAllTypes&#39;])
    pool.AddEnumDescriptor(
        file_descriptor.enum_types_by_name[&#39;ForeignEnum&#39;])
    pool.AddServiceDescriptor(
        file_descriptor.services_by_name[&#39;TestService&#39;])
    pool.AddExtensionDescriptor(
        file_descriptor.extensions_by_name[&#39;optional_int32_extension&#39;])
    pool.Add(unittest_fd)
    pool.Add(conflict_fd)
    pool.FindFileByName(unittest_fd.name)
    with self.assertRaises(TypeError):
      pool.FindFileByName(conflict_fd.name)</code></pre>
</details>
</dd>
<dt id="google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testDefaultValueForCustomMessages"><code class="name flex">
<span>def <span class="ident">testDefaultValueForCustomMessages</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>Check the value returned by non-existent fields.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def testDefaultValueForCustomMessages(self):
  &#34;&#34;&#34;Check the value returned by non-existent fields.&#34;&#34;&#34;
  def _CheckValueAndType(value, expected_value, expected_type):
    self.assertEqual(value, expected_value)
    self.assertIsInstance(value, expected_type)

  def _CheckDefaultValues(msg):
    try:
      int64 = long
    except NameError:  # Python3
      int64 = int
    try:
      unicode_type = unicode
    except NameError:  # Python3
      unicode_type = str
    _CheckValueAndType(msg.optional_int32, 0, int)
    _CheckValueAndType(msg.optional_uint64, 0, (int64, int))
    _CheckValueAndType(msg.optional_float, 0, (float, int))
    _CheckValueAndType(msg.optional_double, 0, (float, int))
    _CheckValueAndType(msg.optional_bool, False, bool)
    _CheckValueAndType(msg.optional_string, u&#39;&#39;, unicode_type)
    _CheckValueAndType(msg.optional_bytes, b&#39;&#39;, bytes)
    _CheckValueAndType(msg.optional_nested_enum, msg.FOO, int)
  # First for the generated message
  _CheckDefaultValues(unittest_pb2.TestAllTypes())
  # Then for a message built with from the DescriptorPool.
  pool = descriptor_pool.DescriptorPool()
  pool.Add(descriptor_pb2.FileDescriptorProto.FromString(
      unittest_import_public_pb2.DESCRIPTOR.serialized_pb))
  pool.Add(descriptor_pb2.FileDescriptorProto.FromString(
      unittest_import_pb2.DESCRIPTOR.serialized_pb))
  pool.Add(descriptor_pb2.FileDescriptorProto.FromString(
      unittest_pb2.DESCRIPTOR.serialized_pb))
  message_class = message_factory.MessageFactory(pool).GetPrototype(
      pool.FindMessageTypeByName(
          unittest_pb2.TestAllTypes.DESCRIPTOR.full_name))
  _CheckDefaultValues(message_class())</code></pre>
</details>
</dd>
<dt id="google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testEnumDefaultValue"><code class="name flex">
<span>def <span class="ident">testEnumDefaultValue</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>Test the default value of enums which don't start at zero.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def testEnumDefaultValue(self):
  &#34;&#34;&#34;Test the default value of enums which don&#39;t start at zero.&#34;&#34;&#34;
  def _CheckDefaultValue(file_descriptor):
    default_value = (file_descriptor
                     .message_types_by_name[&#39;DescriptorPoolTest1&#39;]
                     .fields_by_name[&#39;nested_enum&#39;]
                     .default_value)
    self.assertEqual(default_value,
                     descriptor_pool_test1_pb2.DescriptorPoolTest1.BETA)
  # First check what the generated descriptor contains.
  _CheckDefaultValue(descriptor_pool_test1_pb2.DESCRIPTOR)
  # Then check the generated pool. Normally this is the same descriptor.
  file_descriptor = symbol_database.Default().pool.FindFileByName(
      &#39;google/protobuf/internal/descriptor_pool_test1.proto&#39;)
  self.assertIs(file_descriptor, descriptor_pool_test1_pb2.DESCRIPTOR)
  _CheckDefaultValue(file_descriptor)

  if isinstance(self, SecondaryDescriptorFromDescriptorDB):
    if api_implementation.Type() == &#39;cpp&#39;:
      # Cpp extension cannot call Add on a DescriptorPool
      # that uses a DescriptorDatabase.
      # TODO(jieluo): Fix python and cpp extension diff.
      return
  # Then check the dynamic pool and its internal DescriptorDatabase.
  descriptor_proto = descriptor_pb2.FileDescriptorProto.FromString(
      descriptor_pool_test1_pb2.DESCRIPTOR.serialized_pb)
  self.pool.Add(descriptor_proto)
  # And do the same check as above
  file_descriptor = self.pool.FindFileByName(
      &#39;google/protobuf/internal/descriptor_pool_test1.proto&#39;)
  _CheckDefaultValue(file_descriptor)</code></pre>
</details>
</dd>
<dt id="google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testExtensionsAreNotFields"><code class="name flex">
<span>def <span class="ident">testExtensionsAreNotFields</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def testExtensionsAreNotFields(self):
  with self.assertRaises(KeyError):
    self.pool.FindFieldByName(&#39;google.protobuf.python.internal.another_field&#39;)
  with self.assertRaises(KeyError):
    self.pool.FindFieldByName(
        &#39;google.protobuf.python.internal.Factory2Message.one_more_field&#39;)
  with self.assertRaises(KeyError):
    self.pool.FindExtensionByName(
        &#39;google.protobuf.python.internal.Factory1Message.list_value&#39;)</code></pre>
</details>
</dd>
<dt id="google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testFindAllExtensions"><code class="name flex">
<span>def <span class="ident">testFindAllExtensions</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def testFindAllExtensions(self):
  factory1_message = self.pool.FindMessageTypeByName(
      &#39;google.protobuf.python.internal.Factory1Message&#39;)
  factory2_message = self.pool.FindMessageTypeByName(
      &#39;google.protobuf.python.internal.Factory2Message&#39;)
  # An extension defined in a message.
  one_more_field = factory2_message.extensions_by_name[&#39;one_more_field&#39;]
  self.pool.AddExtensionDescriptor(one_more_field)
  # An extension defined at file scope.
  factory_test2 = self.pool.FindFileByName(
      &#39;google/protobuf/internal/factory_test2.proto&#39;)
  another_field = factory_test2.extensions_by_name[&#39;another_field&#39;]
  self.pool.AddExtensionDescriptor(another_field)

  extensions = self.pool.FindAllExtensions(factory1_message)
  expected_extension_numbers = set([one_more_field, another_field])
  self.assertEqual(expected_extension_numbers, set(extensions))
  # Verify that mutating the returned list does not affect the pool.
  extensions.append(&#39;unexpected_element&#39;)
  # Get the extensions again, the returned value does not contain the
  # &#39;unexpected_element&#39;.
  extensions = self.pool.FindAllExtensions(factory1_message)
  self.assertEqual(expected_extension_numbers, set(extensions))</code></pre>
</details>
</dd>
<dt id="google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testFindEnumTypeByName"><code class="name flex">
<span>def <span class="ident">testFindEnumTypeByName</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def testFindEnumTypeByName(self):
  enum1 = self.pool.FindEnumTypeByName(
      &#39;google.protobuf.python.internal.Factory1Enum&#39;)
  self.assertIsInstance(enum1, descriptor.EnumDescriptor)
  self.assertEqual(0, enum1.values_by_name[&#39;FACTORY_1_VALUE_0&#39;].number)
  self.assertEqual(1, enum1.values_by_name[&#39;FACTORY_1_VALUE_1&#39;].number)
  self.assertFalse(enum1.has_options)

  nested_enum1 = self.pool.FindEnumTypeByName(
      &#39;google.protobuf.python.internal.Factory1Message.NestedFactory1Enum&#39;)
  self.assertIsInstance(nested_enum1, descriptor.EnumDescriptor)
  self.assertEqual(
      0, nested_enum1.values_by_name[&#39;NESTED_FACTORY_1_VALUE_0&#39;].number)
  self.assertEqual(
      1, nested_enum1.values_by_name[&#39;NESTED_FACTORY_1_VALUE_1&#39;].number)

  enum2 = self.pool.FindEnumTypeByName(
      &#39;google.protobuf.python.internal.Factory2Enum&#39;)
  self.assertIsInstance(enum2, descriptor.EnumDescriptor)
  self.assertEqual(0, enum2.values_by_name[&#39;FACTORY_2_VALUE_0&#39;].number)
  self.assertEqual(1, enum2.values_by_name[&#39;FACTORY_2_VALUE_1&#39;].number)

  nested_enum2 = self.pool.FindEnumTypeByName(
      &#39;google.protobuf.python.internal.Factory2Message.NestedFactory2Enum&#39;)
  self.assertIsInstance(nested_enum2, descriptor.EnumDescriptor)
  self.assertEqual(
      0, nested_enum2.values_by_name[&#39;NESTED_FACTORY_2_VALUE_0&#39;].number)
  self.assertEqual(
      1, nested_enum2.values_by_name[&#39;NESTED_FACTORY_2_VALUE_1&#39;].number)</code></pre>
</details>
</dd>
<dt id="google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testFindEnumTypeByNameFailure"><code class="name flex">
<span>def <span class="ident">testFindEnumTypeByNameFailure</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def testFindEnumTypeByNameFailure(self):
  with self.assertRaises(KeyError):
    self.pool.FindEnumTypeByName(&#39;Does not exist&#39;)</code></pre>
</details>
</dd>
<dt id="google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testFindExtensionByName"><code class="name flex">
<span>def <span class="ident">testFindExtensionByName</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def testFindExtensionByName(self):
  # An extension defined in a message.
  extension = self.pool.FindExtensionByName(
      &#39;google.protobuf.python.internal.Factory2Message.one_more_field&#39;)
  self.assertEqual(extension.name, &#39;one_more_field&#39;)
  # An extension defined at file scope.
  extension = self.pool.FindExtensionByName(
      &#39;google.protobuf.python.internal.another_field&#39;)
  self.assertEqual(extension.name, &#39;another_field&#39;)
  self.assertEqual(extension.number, 1002)
  with self.assertRaises(KeyError):
    self.pool.FindFieldByName(&#39;Does not exist&#39;)</code></pre>
</details>
</dd>
<dt id="google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testFindExtensionByNumber"><code class="name flex">
<span>def <span class="ident">testFindExtensionByNumber</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def testFindExtensionByNumber(self):
  factory1_message = self.pool.FindMessageTypeByName(
      &#39;google.protobuf.python.internal.Factory1Message&#39;)
  factory2_message = self.pool.FindMessageTypeByName(
      &#39;google.protobuf.python.internal.Factory2Message&#39;)
  # An extension defined in a message.
  one_more_field = factory2_message.extensions_by_name[&#39;one_more_field&#39;]
  self.pool.AddExtensionDescriptor(one_more_field)
  # An extension defined at file scope.
  factory_test2 = self.pool.FindFileByName(
      &#39;google/protobuf/internal/factory_test2.proto&#39;)
  another_field = factory_test2.extensions_by_name[&#39;another_field&#39;]
  self.pool.AddExtensionDescriptor(another_field)

  # An extension defined in a message.
  extension = self.pool.FindExtensionByNumber(factory1_message, 1001)
  self.assertEqual(extension.name, &#39;one_more_field&#39;)
  # An extension defined at file scope.
  extension = self.pool.FindExtensionByNumber(factory1_message, 1002)
  self.assertEqual(extension.name, &#39;another_field&#39;)
  with self.assertRaises(KeyError):
    extension = self.pool.FindExtensionByNumber(factory1_message, 1234567)</code></pre>
</details>
</dd>
<dt id="google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testFindFieldByName"><code class="name flex">
<span>def <span class="ident">testFindFieldByName</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def testFindFieldByName(self):
  field = self.pool.FindFieldByName(
      &#39;google.protobuf.python.internal.Factory1Message.list_value&#39;)
  self.assertEqual(field.name, &#39;list_value&#39;)
  self.assertEqual(field.label, field.LABEL_REPEATED)
  self.assertFalse(field.has_options)

  with self.assertRaises(KeyError):
    self.pool.FindFieldByName(&#39;Does not exist&#39;)</code></pre>
</details>
</dd>
<dt id="google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testFindFileByName"><code class="name flex">
<span>def <span class="ident">testFindFileByName</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def testFindFileByName(self):
  name1 = &#39;google/protobuf/internal/factory_test1.proto&#39;
  file_desc1 = self.pool.FindFileByName(name1)
  self.assertIsInstance(file_desc1, descriptor.FileDescriptor)
  self.assertEqual(name1, file_desc1.name)
  self.assertEqual(&#39;google.protobuf.python.internal&#39;, file_desc1.package)
  self.assertIn(&#39;Factory1Message&#39;, file_desc1.message_types_by_name)

  name2 = &#39;google/protobuf/internal/factory_test2.proto&#39;
  file_desc2 = self.pool.FindFileByName(name2)
  self.assertIsInstance(file_desc2, descriptor.FileDescriptor)
  self.assertEqual(name2, file_desc2.name)
  self.assertEqual(&#39;google.protobuf.python.internal&#39;, file_desc2.package)
  self.assertIn(&#39;Factory2Message&#39;, file_desc2.message_types_by_name)</code></pre>
</details>
</dd>
<dt id="google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testFindFileByNameFailure"><code class="name flex">
<span>def <span class="ident">testFindFileByNameFailure</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def testFindFileByNameFailure(self):
  with self.assertRaises(KeyError):
    self.pool.FindFileByName(&#39;Does not exist&#39;)</code></pre>
</details>
</dd>
<dt id="google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testFindFileContainingSymbol"><code class="name flex">
<span>def <span class="ident">testFindFileContainingSymbol</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def testFindFileContainingSymbol(self):
  file_desc1 = self.pool.FindFileContainingSymbol(
      &#39;google.protobuf.python.internal.Factory1Message&#39;)
  self.assertIsInstance(file_desc1, descriptor.FileDescriptor)
  self.assertEqual(&#39;google/protobuf/internal/factory_test1.proto&#39;,
                   file_desc1.name)
  self.assertEqual(&#39;google.protobuf.python.internal&#39;, file_desc1.package)
  self.assertIn(&#39;Factory1Message&#39;, file_desc1.message_types_by_name)

  file_desc2 = self.pool.FindFileContainingSymbol(
      &#39;google.protobuf.python.internal.Factory2Message&#39;)
  self.assertIsInstance(file_desc2, descriptor.FileDescriptor)
  self.assertEqual(&#39;google/protobuf/internal/factory_test2.proto&#39;,
                   file_desc2.name)
  self.assertEqual(&#39;google.protobuf.python.internal&#39;, file_desc2.package)
  self.assertIn(&#39;Factory2Message&#39;, file_desc2.message_types_by_name)

  # Tests top level extension.
  file_desc3 = self.pool.FindFileContainingSymbol(
      &#39;google.protobuf.python.internal.another_field&#39;)
  self.assertIsInstance(file_desc3, descriptor.FileDescriptor)
  self.assertEqual(&#39;google/protobuf/internal/factory_test2.proto&#39;,
                   file_desc3.name)

  # Tests nested extension inside a message.
  file_desc4 = self.pool.FindFileContainingSymbol(
      &#39;google.protobuf.python.internal.Factory2Message.one_more_field&#39;)
  self.assertIsInstance(file_desc4, descriptor.FileDescriptor)
  self.assertEqual(&#39;google/protobuf/internal/factory_test2.proto&#39;,
                   file_desc4.name)

  file_desc5 = self.pool.FindFileContainingSymbol(
      &#39;protobuf_unittest.TestService&#39;)
  self.assertIsInstance(file_desc5, descriptor.FileDescriptor)
  self.assertEqual(&#39;google/protobuf/unittest.proto&#39;,
                   file_desc5.name)
  # Tests the generated pool.
  assert descriptor_pool.Default().FindFileContainingSymbol(
      &#39;google.protobuf.python.internal.Factory2Message.one_more_field&#39;)
  assert descriptor_pool.Default().FindFileContainingSymbol(
      &#39;google.protobuf.python.internal.another_field&#39;)
  assert descriptor_pool.Default().FindFileContainingSymbol(
      &#39;protobuf_unittest.TestService&#39;)

  # Can find field.
  file_desc6 = self.pool.FindFileContainingSymbol(
      &#39;google.protobuf.python.internal.Factory1Message.list_value&#39;)
  self.assertIsInstance(file_desc6, descriptor.FileDescriptor)
  self.assertEqual(&#39;google/protobuf/internal/factory_test1.proto&#39;,
                   file_desc6.name)

  # Can find top level Enum value.
  file_desc7 = self.pool.FindFileContainingSymbol(
      &#39;google.protobuf.python.internal.FACTORY_1_VALUE_0&#39;)
  self.assertIsInstance(file_desc7, descriptor.FileDescriptor)
  self.assertEqual(&#39;google/protobuf/internal/factory_test1.proto&#39;,
                   file_desc7.name)

  # Can find nested Enum value.
  file_desc8 = self.pool.FindFileContainingSymbol(
      &#39;protobuf_unittest.TestAllTypes.FOO&#39;)
  self.assertIsInstance(file_desc8, descriptor.FileDescriptor)
  self.assertEqual(&#39;google/protobuf/unittest.proto&#39;,
                   file_desc8.name)

  # TODO(jieluo): Add tests for no package when b/13860351 is fixed.

  self.assertRaises(KeyError, self.pool.FindFileContainingSymbol,
                    &#39;google.protobuf.python.internal.Factory1Message.none_field&#39;)</code></pre>
</details>
</dd>
<dt id="google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testFindFileContainingSymbolFailure"><code class="name flex">
<span>def <span class="ident">testFindFileContainingSymbolFailure</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def testFindFileContainingSymbolFailure(self):
  with self.assertRaises(KeyError):
    self.pool.FindFileContainingSymbol(&#39;Does not exist&#39;)</code></pre>
</details>
</dd>
<dt id="google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testFindMessageTypeByName"><code class="name flex">
<span>def <span class="ident">testFindMessageTypeByName</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def testFindMessageTypeByName(self):
  msg1 = self.pool.FindMessageTypeByName(
      &#39;google.protobuf.python.internal.Factory1Message&#39;)
  self.assertIsInstance(msg1, descriptor.Descriptor)
  self.assertEqual(&#39;Factory1Message&#39;, msg1.name)
  self.assertEqual(&#39;google.protobuf.python.internal.Factory1Message&#39;,
                   msg1.full_name)
  self.assertEqual(None, msg1.containing_type)
  self.assertFalse(msg1.has_options)

  nested_msg1 = msg1.nested_types[0]
  self.assertEqual(&#39;NestedFactory1Message&#39;, nested_msg1.name)
  self.assertEqual(msg1, nested_msg1.containing_type)

  nested_enum1 = msg1.enum_types[0]
  self.assertEqual(&#39;NestedFactory1Enum&#39;, nested_enum1.name)
  self.assertEqual(msg1, nested_enum1.containing_type)

  self.assertEqual(nested_msg1, msg1.fields_by_name[
      &#39;nested_factory_1_message&#39;].message_type)
  self.assertEqual(nested_enum1, msg1.fields_by_name[
      &#39;nested_factory_1_enum&#39;].enum_type)

  msg2 = self.pool.FindMessageTypeByName(
      &#39;google.protobuf.python.internal.Factory2Message&#39;)
  self.assertIsInstance(msg2, descriptor.Descriptor)
  self.assertEqual(&#39;Factory2Message&#39;, msg2.name)
  self.assertEqual(&#39;google.protobuf.python.internal.Factory2Message&#39;,
                   msg2.full_name)
  self.assertIsNone(msg2.containing_type)

  nested_msg2 = msg2.nested_types[0]
  self.assertEqual(&#39;NestedFactory2Message&#39;, nested_msg2.name)
  self.assertEqual(msg2, nested_msg2.containing_type)

  nested_enum2 = msg2.enum_types[0]
  self.assertEqual(&#39;NestedFactory2Enum&#39;, nested_enum2.name)
  self.assertEqual(msg2, nested_enum2.containing_type)

  self.assertEqual(nested_msg2, msg2.fields_by_name[
      &#39;nested_factory_2_message&#39;].message_type)
  self.assertEqual(nested_enum2, msg2.fields_by_name[
      &#39;nested_factory_2_enum&#39;].enum_type)

  self.assertTrue(msg2.fields_by_name[&#39;int_with_default&#39;].has_default_value)
  self.assertEqual(
      1776, msg2.fields_by_name[&#39;int_with_default&#39;].default_value)

  self.assertTrue(
      msg2.fields_by_name[&#39;double_with_default&#39;].has_default_value)
  self.assertEqual(
      9.99, msg2.fields_by_name[&#39;double_with_default&#39;].default_value)

  self.assertTrue(
      msg2.fields_by_name[&#39;string_with_default&#39;].has_default_value)
  self.assertEqual(
      &#39;hello world&#39;, msg2.fields_by_name[&#39;string_with_default&#39;].default_value)

  self.assertTrue(msg2.fields_by_name[&#39;bool_with_default&#39;].has_default_value)
  self.assertFalse(msg2.fields_by_name[&#39;bool_with_default&#39;].default_value)

  self.assertTrue(msg2.fields_by_name[&#39;enum_with_default&#39;].has_default_value)
  self.assertEqual(
      1, msg2.fields_by_name[&#39;enum_with_default&#39;].default_value)

  msg3 = self.pool.FindMessageTypeByName(
      &#39;google.protobuf.python.internal.Factory2Message.NestedFactory2Message&#39;)
  self.assertEqual(nested_msg2, msg3)

  self.assertTrue(msg2.fields_by_name[&#39;bytes_with_default&#39;].has_default_value)
  self.assertEqual(
      b&#39;a\xfb\x00c&#39;,
      msg2.fields_by_name[&#39;bytes_with_default&#39;].default_value)

  self.assertEqual(1, len(msg2.oneofs))
  self.assertEqual(1, len(msg2.oneofs_by_name))
  self.assertEqual(2, len(msg2.oneofs[0].fields))
  for name in [&#39;oneof_int&#39;, &#39;oneof_string&#39;]:
    self.assertEqual(msg2.oneofs[0],
                     msg2.fields_by_name[name].containing_oneof)
    self.assertIn(msg2.fields_by_name[name], msg2.oneofs[0].fields)</code></pre>
</details>
</dd>
<dt id="google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testFindMessageTypeByNameFailure"><code class="name flex">
<span>def <span class="ident">testFindMessageTypeByNameFailure</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def testFindMessageTypeByNameFailure(self):
  with self.assertRaises(KeyError):
    self.pool.FindMessageTypeByName(&#39;Does not exist&#39;)</code></pre>
</details>
</dd>
<dt id="google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testFindOneofByName"><code class="name flex">
<span>def <span class="ident">testFindOneofByName</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def testFindOneofByName(self):
  oneof = self.pool.FindOneofByName(
      &#39;google.protobuf.python.internal.Factory2Message.oneof_field&#39;)
  self.assertEqual(oneof.name, &#39;oneof_field&#39;)
  with self.assertRaises(KeyError):
    self.pool.FindOneofByName(&#39;Does not exist&#39;)</code></pre>
</details>
</dd>
<dt id="google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testFindService"><code class="name flex">
<span>def <span class="ident">testFindService</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def testFindService(self):
  service = self.pool.FindServiceByName(&#39;protobuf_unittest.TestService&#39;)
  self.assertEqual(service.full_name, &#39;protobuf_unittest.TestService&#39;)
  with self.assertRaises(KeyError):
    self.pool.FindServiceByName(&#39;Does not exist&#39;)

  method = self.pool.FindMethodByName(&#39;protobuf_unittest.TestService.Foo&#39;)
  self.assertIs(method.containing_service, service)
  with self.assertRaises(KeyError):
    self.pool.FindMethodByName(&#39;protobuf_unittest.TestService.Doesnotexist&#39;)</code></pre>
</details>
</dd>
<dt id="google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testFindTypeErrors"><code class="name flex">
<span>def <span class="ident">testFindTypeErrors</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def testFindTypeErrors(self):
  self.assertRaises(TypeError, self.pool.FindExtensionByNumber, &#39;&#39;)
  self.assertRaises(KeyError, self.pool.FindMethodByName, &#39;&#39;)

  # TODO(jieluo): Fix python to raise correct errors.
  if api_implementation.Type() == &#39;cpp&#39;:
    error_type = TypeError
  else:
    error_type = AttributeError
  self.assertRaises(error_type, self.pool.FindMessageTypeByName, 0)
  self.assertRaises(error_type, self.pool.FindFieldByName, 0)
  self.assertRaises(error_type, self.pool.FindExtensionByName, 0)
  self.assertRaises(error_type, self.pool.FindEnumTypeByName, 0)
  self.assertRaises(error_type, self.pool.FindOneofByName, 0)
  self.assertRaises(error_type, self.pool.FindServiceByName, 0)
  self.assertRaises(error_type, self.pool.FindMethodByName, 0)
  self.assertRaises(error_type, self.pool.FindFileContainingSymbol, 0)
  if api_implementation.Type() == &#39;python&#39;:
    error_type = KeyError
  self.assertRaises(error_type, self.pool.FindFileByName, 0)</code></pre>
</details>
</dd>
<dt id="google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testUserDefinedDB"><code class="name flex">
<span>def <span class="ident">testUserDefinedDB</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def testUserDefinedDB(self):
  db = descriptor_database.DescriptorDatabase()
  self.pool = descriptor_pool.DescriptorPool(db)
  db.Add(self.factory_test1_fd)
  db.Add(self.factory_test2_fd)
  self.testFindMessageTypeByName()</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="google.protobuf.internal.descriptor_pool_test.EnumField"><code class="flex name class">
<span>class <span class="ident">EnumField</span></span>
<span>(</span><span>number, type_name, default_value)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class EnumField(object):

  def __init__(self, number, type_name, default_value):
    self.number = number
    self.type_name = type_name
    self.default_value = default_value

  def CheckField(self, test, msg_desc, name, index, file_desc):
    field_desc = msg_desc.fields_by_name[name]
    enum_desc = msg_desc.enum_types_by_name[self.type_name]
    test.assertEqual(name, field_desc.name)
    expected_field_full_name = &#39;.&#39;.join([msg_desc.full_name, name])
    test.assertEqual(expected_field_full_name, field_desc.full_name)
    test.assertEqual(index, field_desc.index)
    test.assertEqual(self.number, field_desc.number)
    test.assertEqual(descriptor.FieldDescriptor.TYPE_ENUM, field_desc.type)
    test.assertEqual(descriptor.FieldDescriptor.CPPTYPE_ENUM,
                     field_desc.cpp_type)
    test.assertTrue(field_desc.has_default_value)
    test.assertEqual(enum_desc.values_by_name[self.default_value].number,
                     field_desc.default_value)
    test.assertFalse(enum_desc.values_by_name[self.default_value].has_options)
    test.assertEqual(msg_desc, field_desc.containing_type)
    test.assertEqual(enum_desc, field_desc.enum_type)
    test.assertEqual(file_desc, enum_desc.file)</code></pre>
</details>
<h3>Methods</h3>
<dl>
<dt id="google.protobuf.internal.descriptor_pool_test.EnumField.CheckField"><code class="name flex">
<span>def <span class="ident">CheckField</span></span>(<span>self, test, msg_desc, name, index, file_desc)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def CheckField(self, test, msg_desc, name, index, file_desc):
  field_desc = msg_desc.fields_by_name[name]
  enum_desc = msg_desc.enum_types_by_name[self.type_name]
  test.assertEqual(name, field_desc.name)
  expected_field_full_name = &#39;.&#39;.join([msg_desc.full_name, name])
  test.assertEqual(expected_field_full_name, field_desc.full_name)
  test.assertEqual(index, field_desc.index)
  test.assertEqual(self.number, field_desc.number)
  test.assertEqual(descriptor.FieldDescriptor.TYPE_ENUM, field_desc.type)
  test.assertEqual(descriptor.FieldDescriptor.CPPTYPE_ENUM,
                   field_desc.cpp_type)
  test.assertTrue(field_desc.has_default_value)
  test.assertEqual(enum_desc.values_by_name[self.default_value].number,
                   field_desc.default_value)
  test.assertFalse(enum_desc.values_by_name[self.default_value].has_options)
  test.assertEqual(msg_desc, field_desc.containing_type)
  test.assertEqual(enum_desc, field_desc.enum_type)
  test.assertEqual(file_desc, enum_desc.file)</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="google.protobuf.internal.descriptor_pool_test.EnumType"><code class="flex name class">
<span>class <span class="ident">EnumType</span></span>
<span>(</span><span>values)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class EnumType(object):

  def __init__(self, values):
    self.values = values

  def CheckType(self, test, msg_desc, name, file_desc):
    enum_desc = msg_desc.enum_types_by_name[name]
    test.assertEqual(name, enum_desc.name)
    expected_enum_full_name = &#39;.&#39;.join([msg_desc.full_name, name])
    test.assertEqual(expected_enum_full_name, enum_desc.full_name)
    test.assertEqual(msg_desc, enum_desc.containing_type)
    test.assertEqual(file_desc, enum_desc.file)
    for index, (value, number) in enumerate(self.values):
      value_desc = enum_desc.values_by_name[value]
      test.assertEqual(value, value_desc.name)
      test.assertEqual(index, value_desc.index)
      test.assertEqual(number, value_desc.number)
      test.assertEqual(enum_desc, value_desc.type)
      test.assertIn(value, msg_desc.enum_values_by_name)</code></pre>
</details>
<h3>Methods</h3>
<dl>
<dt id="google.protobuf.internal.descriptor_pool_test.EnumType.CheckType"><code class="name flex">
<span>def <span class="ident">CheckType</span></span>(<span>self, test, msg_desc, name, file_desc)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def CheckType(self, test, msg_desc, name, file_desc):
  enum_desc = msg_desc.enum_types_by_name[name]
  test.assertEqual(name, enum_desc.name)
  expected_enum_full_name = &#39;.&#39;.join([msg_desc.full_name, name])
  test.assertEqual(expected_enum_full_name, enum_desc.full_name)
  test.assertEqual(msg_desc, enum_desc.containing_type)
  test.assertEqual(file_desc, enum_desc.file)
  for index, (value, number) in enumerate(self.values):
    value_desc = enum_desc.values_by_name[value]
    test.assertEqual(value, value_desc.name)
    test.assertEqual(index, value_desc.index)
    test.assertEqual(number, value_desc.number)
    test.assertEqual(enum_desc, value_desc.type)
    test.assertIn(value, msg_desc.enum_values_by_name)</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="google.protobuf.internal.descriptor_pool_test.ExtensionField"><code class="flex name class">
<span>class <span class="ident">ExtensionField</span></span>
<span>(</span><span>number, extended_type)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class ExtensionField(object):

  def __init__(self, number, extended_type):
    self.number = number
    self.extended_type = extended_type

  def CheckField(self, test, msg_desc, name, index, file_desc):
    field_desc = msg_desc.extensions_by_name[name]
    test.assertEqual(name, field_desc.name)
    expected_field_full_name = &#39;.&#39;.join([msg_desc.full_name, name])
    test.assertEqual(expected_field_full_name, field_desc.full_name)
    test.assertEqual(self.number, field_desc.number)
    test.assertEqual(index, field_desc.index)
    test.assertEqual(descriptor.FieldDescriptor.TYPE_MESSAGE, field_desc.type)
    test.assertEqual(descriptor.FieldDescriptor.CPPTYPE_MESSAGE,
                     field_desc.cpp_type)
    test.assertFalse(field_desc.has_default_value)
    test.assertTrue(field_desc.is_extension)
    test.assertEqual(msg_desc, field_desc.extension_scope)
    test.assertEqual(msg_desc, field_desc.message_type)
    test.assertEqual(self.extended_type, field_desc.containing_type.name)
    test.assertEqual(file_desc, field_desc.file)</code></pre>
</details>
<h3>Methods</h3>
<dl>
<dt id="google.protobuf.internal.descriptor_pool_test.ExtensionField.CheckField"><code class="name flex">
<span>def <span class="ident">CheckField</span></span>(<span>self, test, msg_desc, name, index, file_desc)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def CheckField(self, test, msg_desc, name, index, file_desc):
  field_desc = msg_desc.extensions_by_name[name]
  test.assertEqual(name, field_desc.name)
  expected_field_full_name = &#39;.&#39;.join([msg_desc.full_name, name])
  test.assertEqual(expected_field_full_name, field_desc.full_name)
  test.assertEqual(self.number, field_desc.number)
  test.assertEqual(index, field_desc.index)
  test.assertEqual(descriptor.FieldDescriptor.TYPE_MESSAGE, field_desc.type)
  test.assertEqual(descriptor.FieldDescriptor.CPPTYPE_MESSAGE,
                   field_desc.cpp_type)
  test.assertFalse(field_desc.has_default_value)
  test.assertTrue(field_desc.is_extension)
  test.assertEqual(msg_desc, field_desc.extension_scope)
  test.assertEqual(msg_desc, field_desc.message_type)
  test.assertEqual(self.extended_type, field_desc.containing_type.name)
  test.assertEqual(file_desc, field_desc.file)</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="google.protobuf.internal.descriptor_pool_test.MessageField"><code class="flex name class">
<span>class <span class="ident">MessageField</span></span>
<span>(</span><span>number, type_name)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class MessageField(object):

  def __init__(self, number, type_name):
    self.number = number
    self.type_name = type_name

  def CheckField(self, test, msg_desc, name, index, file_desc):
    field_desc = msg_desc.fields_by_name[name]
    field_type_desc = msg_desc.nested_types_by_name[self.type_name]
    test.assertEqual(name, field_desc.name)
    expected_field_full_name = &#39;.&#39;.join([msg_desc.full_name, name])
    test.assertEqual(expected_field_full_name, field_desc.full_name)
    test.assertEqual(index, field_desc.index)
    test.assertEqual(self.number, field_desc.number)
    test.assertEqual(descriptor.FieldDescriptor.TYPE_MESSAGE, field_desc.type)
    test.assertEqual(descriptor.FieldDescriptor.CPPTYPE_MESSAGE,
                     field_desc.cpp_type)
    test.assertFalse(field_desc.has_default_value)
    test.assertEqual(msg_desc, field_desc.containing_type)
    test.assertEqual(field_type_desc, field_desc.message_type)
    test.assertEqual(file_desc, field_desc.file)
    test.assertEqual(field_desc.default_value, None)</code></pre>
</details>
<h3>Methods</h3>
<dl>
<dt id="google.protobuf.internal.descriptor_pool_test.MessageField.CheckField"><code class="name flex">
<span>def <span class="ident">CheckField</span></span>(<span>self, test, msg_desc, name, index, file_desc)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def CheckField(self, test, msg_desc, name, index, file_desc):
  field_desc = msg_desc.fields_by_name[name]
  field_type_desc = msg_desc.nested_types_by_name[self.type_name]
  test.assertEqual(name, field_desc.name)
  expected_field_full_name = &#39;.&#39;.join([msg_desc.full_name, name])
  test.assertEqual(expected_field_full_name, field_desc.full_name)
  test.assertEqual(index, field_desc.index)
  test.assertEqual(self.number, field_desc.number)
  test.assertEqual(descriptor.FieldDescriptor.TYPE_MESSAGE, field_desc.type)
  test.assertEqual(descriptor.FieldDescriptor.CPPTYPE_MESSAGE,
                   field_desc.cpp_type)
  test.assertFalse(field_desc.has_default_value)
  test.assertEqual(msg_desc, field_desc.containing_type)
  test.assertEqual(field_type_desc, field_desc.message_type)
  test.assertEqual(file_desc, field_desc.file)
  test.assertEqual(field_desc.default_value, None)</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="google.protobuf.internal.descriptor_pool_test.MessageType"><code class="flex name class">
<span>class <span class="ident">MessageType</span></span>
<span>(</span><span>type_dict, field_list, is_extendable=False, extensions=None)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class MessageType(object):

  def __init__(self, type_dict, field_list, is_extendable=False,
               extensions=None):
    self.type_dict = type_dict
    self.field_list = field_list
    self.is_extendable = is_extendable
    self.extensions = extensions or []

  def CheckType(self, test, containing_type_desc, name, file_desc):
    if containing_type_desc is None:
      desc = file_desc.message_types_by_name[name]
      expected_full_name = &#39;.&#39;.join([file_desc.package, name])
    else:
      desc = containing_type_desc.nested_types_by_name[name]
      expected_full_name = &#39;.&#39;.join([containing_type_desc.full_name, name])

    test.assertEqual(name, desc.name)
    test.assertEqual(expected_full_name, desc.full_name)
    test.assertEqual(containing_type_desc, desc.containing_type)
    test.assertEqual(desc.file, file_desc)
    test.assertEqual(self.is_extendable, desc.is_extendable)
    for name, subtype in self.type_dict.items():
      subtype.CheckType(test, desc, name, file_desc)

    for index, (name, field) in enumerate(self.field_list):
      field.CheckField(test, desc, name, index, file_desc)

    for index, (name, field) in enumerate(self.extensions):
      field.CheckField(test, desc, name, index, file_desc)</code></pre>
</details>
<h3>Methods</h3>
<dl>
<dt id="google.protobuf.internal.descriptor_pool_test.MessageType.CheckType"><code class="name flex">
<span>def <span class="ident">CheckType</span></span>(<span>self, test, containing_type_desc, name, file_desc)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def CheckType(self, test, containing_type_desc, name, file_desc):
  if containing_type_desc is None:
    desc = file_desc.message_types_by_name[name]
    expected_full_name = &#39;.&#39;.join([file_desc.package, name])
  else:
    desc = containing_type_desc.nested_types_by_name[name]
    expected_full_name = &#39;.&#39;.join([containing_type_desc.full_name, name])

  test.assertEqual(name, desc.name)
  test.assertEqual(expected_full_name, desc.full_name)
  test.assertEqual(containing_type_desc, desc.containing_type)
  test.assertEqual(desc.file, file_desc)
  test.assertEqual(self.is_extendable, desc.is_extendable)
  for name, subtype in self.type_dict.items():
    subtype.CheckType(test, desc, name, file_desc)

  for index, (name, field) in enumerate(self.field_list):
    field.CheckField(test, desc, name, index, file_desc)

  for index, (name, field) in enumerate(self.extensions):
    field.CheckField(test, desc, name, index, file_desc)</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="google.protobuf.internal.descriptor_pool_test.ProtoFile"><code class="flex name class">
<span>class <span class="ident">ProtoFile</span></span>
<span>(</span><span>name, package, messages, dependencies=None, public_dependencies=None)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class ProtoFile(object):

  def __init__(self, name, package, messages, dependencies=None,
               public_dependencies=None):
    self.name = name
    self.package = package
    self.messages = messages
    self.dependencies = dependencies or []
    self.public_dependencies = public_dependencies or []

  def CheckFile(self, test, pool):
    file_desc = pool.FindFileByName(self.name)
    test.assertEqual(self.name, file_desc.name)
    test.assertEqual(self.package, file_desc.package)
    dependencies_names = [f.name for f in file_desc.dependencies]
    test.assertEqual(self.dependencies, dependencies_names)
    public_dependencies_names = [f.name for f in file_desc.public_dependencies]
    test.assertEqual(self.public_dependencies, public_dependencies_names)
    for name, msg_type in self.messages.items():
      msg_type.CheckType(test, None, name, file_desc)</code></pre>
</details>
<h3>Methods</h3>
<dl>
<dt id="google.protobuf.internal.descriptor_pool_test.ProtoFile.CheckFile"><code class="name flex">
<span>def <span class="ident">CheckFile</span></span>(<span>self, test, pool)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def CheckFile(self, test, pool):
  file_desc = pool.FindFileByName(self.name)
  test.assertEqual(self.name, file_desc.name)
  test.assertEqual(self.package, file_desc.package)
  dependencies_names = [f.name for f in file_desc.dependencies]
  test.assertEqual(self.dependencies, dependencies_names)
  public_dependencies_names = [f.name for f in file_desc.public_dependencies]
  test.assertEqual(self.public_dependencies, public_dependencies_names)
  for name, msg_type in self.messages.items():
    msg_type.CheckType(test, None, name, file_desc)</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="google.protobuf.internal.descriptor_pool_test.SecondaryDescriptorFromDescriptorDB"><code class="flex name class">
<span>class <span class="ident">SecondaryDescriptorFromDescriptorDB</span></span>
<span>(</span><span>methodName='runTest')</span>
</code></dt>
<dd>
<section class="desc"><p>A class whose instances are single test cases.</p>
<p>By default, the test code itself should be placed in a method named
'runTest'.</p>
<p>If the fixture may be used for many test cases, create as
many test methods as are needed. When instantiating such a TestCase
subclass, specify in the constructor arguments the name of the test method
that the instance is to execute.</p>
<p>Test authors should subclass TestCase for their own tests. Construction
and deconstruction of the test's environment ('fixture') can be
implemented by overriding the 'setUp' and 'tearDown' methods respectively.</p>
<p>If it is necessary to override the <strong>init</strong> method, the base class
<strong>init</strong> method must always be called. It is important that subclasses
should not change the signature of their <strong>init</strong> method, since instances
of the classes are instantiated automatically by parts of the framework
in order to be run.</p>
<p>When subclassing TestCase, you can set these attributes:
* failureException: determines which exception will be raised when
the instance's assertion methods fail; test methods raising this
exception will be deemed to have 'failed' rather than 'errored'.
* longMessage: determines whether long messages (including repr of
objects used in assert methods) will be printed on failure in <em>addition</em>
to any explicit message passed.
* maxDiff: sets the maximum length of a diff in failure messages
by assert methods using difflib. It is looked up as an instance
attribute so can be configured by individual tests if required.</p>
<p>Create an instance of the class that will use the named test
method when executed. Raises a ValueError if the instance does
not have a method with the specified name.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class SecondaryDescriptorFromDescriptorDB(DescriptorPoolTestBase,
                                          unittest.TestCase):

  def setUp(self):
    self.factory_test1_fd = descriptor_pb2.FileDescriptorProto.FromString(
        factory_test1_pb2.DESCRIPTOR.serialized_pb)
    self.factory_test2_fd = descriptor_pb2.FileDescriptorProto.FromString(
        factory_test2_pb2.DESCRIPTOR.serialized_pb)
    self.db = descriptor_database.DescriptorDatabase()
    self.db.Add(self.factory_test1_fd)
    self.db.Add(self.factory_test2_fd)
    self.db.Add(descriptor_pb2.FileDescriptorProto.FromString(
        unittest_import_public_pb2.DESCRIPTOR.serialized_pb))
    self.db.Add(descriptor_pb2.FileDescriptorProto.FromString(
        unittest_import_pb2.DESCRIPTOR.serialized_pb))
    self.db.Add(descriptor_pb2.FileDescriptorProto.FromString(
        unittest_pb2.DESCRIPTOR.serialized_pb))
    self.db.Add(descriptor_pb2.FileDescriptorProto.FromString(
        no_package_pb2.DESCRIPTOR.serialized_pb))
    self.pool = descriptor_pool.DescriptorPool(descriptor_db=self.db)

  def testErrorCollector(self):
    file_proto = descriptor_pb2.FileDescriptorProto()
    file_proto.package = &#39;collector&#39;
    file_proto.name = &#39;error_file&#39;
    message_type = file_proto.message_type.add()
    message_type.name = &#39;ErrorMessage&#39;
    field = message_type.field.add()
    field.number = 1
    field.name = &#39;nested_message_field&#39;
    field.label = descriptor.FieldDescriptor.LABEL_OPTIONAL
    field.type = descriptor.FieldDescriptor.TYPE_MESSAGE
    field.type_name = &#39;SubMessage&#39;
    oneof = message_type.oneof_decl.add()
    oneof.name = &#39;MyOneof&#39;
    enum_type = file_proto.enum_type.add()
    enum_type.name = &#39;MyEnum&#39;
    enum_value = enum_type.value.add()
    enum_value.name = &#39;MyEnumValue&#39;
    enum_value.number = 0
    self.db.Add(file_proto)

    self.assertRaisesRegexp(KeyError, &#39;SubMessage&#39;,
                            self.pool.FindMessageTypeByName,
                            &#39;collector.ErrorMessage&#39;)
    self.assertRaisesRegexp(KeyError, &#39;SubMessage&#39;,
                            self.pool.FindFileByName, &#39;error_file&#39;)
    with self.assertRaises(KeyError) as exc:
      self.pool.FindFileByName(&#39;none_file&#39;)
    self.assertIn(str(exc.exception), (&#39;\&#39;none_file\&#39;&#39;,
                                       &#39;\&#34;Couldn\&#39;t find file none_file\&#34;&#39;))

    # Pure python _ConvertFileProtoToFileDescriptor() method has side effect
    # that all the symbols found in the file will load into the pool even the
    # file can not build. So when FindMessageTypeByName(&#39;ErrorMessage&#39;) was
    # called the first time, a KeyError will be raised but call the find
    # method later will return a descriptor which is not build.
    # TODO(jieluo): fix pure python to revert the load if file can not be build
    if api_implementation.Type() == &#39;cpp&#39;:
      error_msg = (&#39;Invalid proto descriptor for file &#34;error_file&#34;:\\n  &#39;
                   &#39;collector.ErrorMessage.nested_message_field: &#34;SubMessage&#34; &#39;
                   &#39;is not defined.\\n  collector.ErrorMessage.MyOneof: Oneof &#39;
                   &#39;must have at least one field.\\n\&#39;&#39;)
      with self.assertRaises(KeyError) as exc:
        self.pool.FindMessageTypeByName(&#39;collector.ErrorMessage&#39;)
      self.assertEqual(str(exc.exception), &#39;\&#39;Couldn\\\&#39;t build file for &#39;
                       &#39;message collector.ErrorMessage\\n&#39; + error_msg)

      with self.assertRaises(KeyError) as exc:
        self.pool.FindFieldByName(&#39;collector.ErrorMessage.nested_message_field&#39;)
      self.assertEqual(str(exc.exception), &#39;\&#39;Couldn\\\&#39;t build file for field&#39;
                       &#39; collector.ErrorMessage.nested_message_field\\n&#39;
                       + error_msg)

      with self.assertRaises(KeyError) as exc:
        self.pool.FindEnumTypeByName(&#39;collector.MyEnum&#39;)
      self.assertEqual(str(exc.exception), &#39;\&#39;Couldn\\\&#39;t build file for enum&#39;
                       &#39; collector.MyEnum\\n&#39; + error_msg)

      with self.assertRaises(KeyError) as exc:
        self.pool.FindFileContainingSymbol(&#39;collector.MyEnumValue&#39;)
      self.assertEqual(str(exc.exception), &#39;\&#39;Couldn\\\&#39;t build file for symbol&#39;
                       &#39; collector.MyEnumValue\\n&#39; + error_msg)

      with self.assertRaises(KeyError) as exc:
        self.pool.FindOneofByName(&#39;collector.ErrorMessage.MyOneof&#39;)
      self.assertEqual(str(exc.exception), &#39;\&#39;Couldn\\\&#39;t build file for oneof&#39;
                       &#39; collector.ErrorMessage.MyOneof\\n&#39; + error_msg)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase" href="#google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase">DescriptorPoolTestBase</a></li>
<li>unittest.case.TestCase</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="google.protobuf.internal.descriptor_pool_test.SecondaryDescriptorFromDescriptorDB.setUp"><code class="name flex">
<span>def <span class="ident">setUp</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>Hook method for setting up the test fixture before exercising it.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def setUp(self):
  self.factory_test1_fd = descriptor_pb2.FileDescriptorProto.FromString(
      factory_test1_pb2.DESCRIPTOR.serialized_pb)
  self.factory_test2_fd = descriptor_pb2.FileDescriptorProto.FromString(
      factory_test2_pb2.DESCRIPTOR.serialized_pb)
  self.db = descriptor_database.DescriptorDatabase()
  self.db.Add(self.factory_test1_fd)
  self.db.Add(self.factory_test2_fd)
  self.db.Add(descriptor_pb2.FileDescriptorProto.FromString(
      unittest_import_public_pb2.DESCRIPTOR.serialized_pb))
  self.db.Add(descriptor_pb2.FileDescriptorProto.FromString(
      unittest_import_pb2.DESCRIPTOR.serialized_pb))
  self.db.Add(descriptor_pb2.FileDescriptorProto.FromString(
      unittest_pb2.DESCRIPTOR.serialized_pb))
  self.db.Add(descriptor_pb2.FileDescriptorProto.FromString(
      no_package_pb2.DESCRIPTOR.serialized_pb))
  self.pool = descriptor_pool.DescriptorPool(descriptor_db=self.db)</code></pre>
</details>
</dd>
<dt id="google.protobuf.internal.descriptor_pool_test.SecondaryDescriptorFromDescriptorDB.testErrorCollector"><code class="name flex">
<span>def <span class="ident">testErrorCollector</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def testErrorCollector(self):
  file_proto = descriptor_pb2.FileDescriptorProto()
  file_proto.package = &#39;collector&#39;
  file_proto.name = &#39;error_file&#39;
  message_type = file_proto.message_type.add()
  message_type.name = &#39;ErrorMessage&#39;
  field = message_type.field.add()
  field.number = 1
  field.name = &#39;nested_message_field&#39;
  field.label = descriptor.FieldDescriptor.LABEL_OPTIONAL
  field.type = descriptor.FieldDescriptor.TYPE_MESSAGE
  field.type_name = &#39;SubMessage&#39;
  oneof = message_type.oneof_decl.add()
  oneof.name = &#39;MyOneof&#39;
  enum_type = file_proto.enum_type.add()
  enum_type.name = &#39;MyEnum&#39;
  enum_value = enum_type.value.add()
  enum_value.name = &#39;MyEnumValue&#39;
  enum_value.number = 0
  self.db.Add(file_proto)

  self.assertRaisesRegexp(KeyError, &#39;SubMessage&#39;,
                          self.pool.FindMessageTypeByName,
                          &#39;collector.ErrorMessage&#39;)
  self.assertRaisesRegexp(KeyError, &#39;SubMessage&#39;,
                          self.pool.FindFileByName, &#39;error_file&#39;)
  with self.assertRaises(KeyError) as exc:
    self.pool.FindFileByName(&#39;none_file&#39;)
  self.assertIn(str(exc.exception), (&#39;\&#39;none_file\&#39;&#39;,
                                     &#39;\&#34;Couldn\&#39;t find file none_file\&#34;&#39;))

  # Pure python _ConvertFileProtoToFileDescriptor() method has side effect
  # that all the symbols found in the file will load into the pool even the
  # file can not build. So when FindMessageTypeByName(&#39;ErrorMessage&#39;) was
  # called the first time, a KeyError will be raised but call the find
  # method later will return a descriptor which is not build.
  # TODO(jieluo): fix pure python to revert the load if file can not be build
  if api_implementation.Type() == &#39;cpp&#39;:
    error_msg = (&#39;Invalid proto descriptor for file &#34;error_file&#34;:\\n  &#39;
                 &#39;collector.ErrorMessage.nested_message_field: &#34;SubMessage&#34; &#39;
                 &#39;is not defined.\\n  collector.ErrorMessage.MyOneof: Oneof &#39;
                 &#39;must have at least one field.\\n\&#39;&#39;)
    with self.assertRaises(KeyError) as exc:
      self.pool.FindMessageTypeByName(&#39;collector.ErrorMessage&#39;)
    self.assertEqual(str(exc.exception), &#39;\&#39;Couldn\\\&#39;t build file for &#39;
                     &#39;message collector.ErrorMessage\\n&#39; + error_msg)

    with self.assertRaises(KeyError) as exc:
      self.pool.FindFieldByName(&#39;collector.ErrorMessage.nested_message_field&#39;)
    self.assertEqual(str(exc.exception), &#39;\&#39;Couldn\\\&#39;t build file for field&#39;
                     &#39; collector.ErrorMessage.nested_message_field\\n&#39;
                     + error_msg)

    with self.assertRaises(KeyError) as exc:
      self.pool.FindEnumTypeByName(&#39;collector.MyEnum&#39;)
    self.assertEqual(str(exc.exception), &#39;\&#39;Couldn\\\&#39;t build file for enum&#39;
                     &#39; collector.MyEnum\\n&#39; + error_msg)

    with self.assertRaises(KeyError) as exc:
      self.pool.FindFileContainingSymbol(&#39;collector.MyEnumValue&#39;)
    self.assertEqual(str(exc.exception), &#39;\&#39;Couldn\\\&#39;t build file for symbol&#39;
                     &#39; collector.MyEnumValue\\n&#39; + error_msg)

    with self.assertRaises(KeyError) as exc:
      self.pool.FindOneofByName(&#39;collector.ErrorMessage.MyOneof&#39;)
    self.assertEqual(str(exc.exception), &#39;\&#39;Couldn\\\&#39;t build file for oneof&#39;
                     &#39; collector.ErrorMessage.MyOneof\\n&#39; + error_msg)</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase" href="#google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase">DescriptorPoolTestBase</a></b></code>:
<ul class="hlist">
<li><code><a title="google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testDefaultValueForCustomMessages" href="#google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testDefaultValueForCustomMessages">testDefaultValueForCustomMessages</a></code></li>
<li><code><a title="google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testEnumDefaultValue" href="#google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testEnumDefaultValue">testEnumDefaultValue</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="google.protobuf.internal.descriptor_pool_test.StringField"><code class="flex name class">
<span>class <span class="ident">StringField</span></span>
<span>(</span><span>number, default_value)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class StringField(object):

  def __init__(self, number, default_value):
    self.number = number
    self.default_value = default_value

  def CheckField(self, test, msg_desc, name, index, file_desc):
    field_desc = msg_desc.fields_by_name[name]
    test.assertEqual(name, field_desc.name)
    expected_field_full_name = &#39;.&#39;.join([msg_desc.full_name, name])
    test.assertEqual(expected_field_full_name, field_desc.full_name)
    test.assertEqual(index, field_desc.index)
    test.assertEqual(self.number, field_desc.number)
    test.assertEqual(descriptor.FieldDescriptor.TYPE_STRING, field_desc.type)
    test.assertEqual(descriptor.FieldDescriptor.CPPTYPE_STRING,
                     field_desc.cpp_type)
    test.assertTrue(field_desc.has_default_value)
    test.assertEqual(self.default_value, field_desc.default_value)
    test.assertEqual(file_desc, field_desc.file)</code></pre>
</details>
<h3>Methods</h3>
<dl>
<dt id="google.protobuf.internal.descriptor_pool_test.StringField.CheckField"><code class="name flex">
<span>def <span class="ident">CheckField</span></span>(<span>self, test, msg_desc, name, index, file_desc)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def CheckField(self, test, msg_desc, name, index, file_desc):
  field_desc = msg_desc.fields_by_name[name]
  test.assertEqual(name, field_desc.name)
  expected_field_full_name = &#39;.&#39;.join([msg_desc.full_name, name])
  test.assertEqual(expected_field_full_name, field_desc.full_name)
  test.assertEqual(index, field_desc.index)
  test.assertEqual(self.number, field_desc.number)
  test.assertEqual(descriptor.FieldDescriptor.TYPE_STRING, field_desc.type)
  test.assertEqual(descriptor.FieldDescriptor.CPPTYPE_STRING,
                   field_desc.cpp_type)
  test.assertTrue(field_desc.has_default_value)
  test.assertEqual(self.default_value, field_desc.default_value)
  test.assertEqual(file_desc, field_desc.file)</code></pre>
</details>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="google.protobuf.internal" href="index.html">google.protobuf.internal</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="google.protobuf.internal.descriptor_pool_test.AddDescriptorTest" href="#google.protobuf.internal.descriptor_pool_test.AddDescriptorTest">AddDescriptorTest</a></code></h4>
<ul class="">
<li><code><a title="google.protobuf.internal.descriptor_pool_test.AddDescriptorTest.testAddTypeError" href="#google.protobuf.internal.descriptor_pool_test.AddDescriptorTest.testAddTypeError">testAddTypeError</a></code></li>
<li><code><a title="google.protobuf.internal.descriptor_pool_test.AddDescriptorTest.testCustomDescriptorPool" href="#google.protobuf.internal.descriptor_pool_test.AddDescriptorTest.testCustomDescriptorPool">testCustomDescriptorPool</a></code></li>
<li><code><a title="google.protobuf.internal.descriptor_pool_test.AddDescriptorTest.testEmptyDescriptorPool" href="#google.protobuf.internal.descriptor_pool_test.AddDescriptorTest.testEmptyDescriptorPool">testEmptyDescriptorPool</a></code></li>
<li><code><a title="google.protobuf.internal.descriptor_pool_test.AddDescriptorTest.testEnum" href="#google.protobuf.internal.descriptor_pool_test.AddDescriptorTest.testEnum">testEnum</a></code></li>
<li><code><a title="google.protobuf.internal.descriptor_pool_test.AddDescriptorTest.testFile" href="#google.protobuf.internal.descriptor_pool_test.AddDescriptorTest.testFile">testFile</a></code></li>
<li><code><a title="google.protobuf.internal.descriptor_pool_test.AddDescriptorTest.testFileDescriptorOptionsWithCustomDescriptorPool" href="#google.protobuf.internal.descriptor_pool_test.AddDescriptorTest.testFileDescriptorOptionsWithCustomDescriptorPool">testFileDescriptorOptionsWithCustomDescriptorPool</a></code></li>
<li><code><a title="google.protobuf.internal.descriptor_pool_test.AddDescriptorTest.testMessage" href="#google.protobuf.internal.descriptor_pool_test.AddDescriptorTest.testMessage">testMessage</a></code></li>
<li><code><a title="google.protobuf.internal.descriptor_pool_test.AddDescriptorTest.testService" href="#google.protobuf.internal.descriptor_pool_test.AddDescriptorTest.testService">testService</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="google.protobuf.internal.descriptor_pool_test.CreateDescriptorPoolTest" href="#google.protobuf.internal.descriptor_pool_test.CreateDescriptorPoolTest">CreateDescriptorPoolTest</a></code></h4>
<ul class="">
<li><code><a title="google.protobuf.internal.descriptor_pool_test.CreateDescriptorPoolTest.setUp" href="#google.protobuf.internal.descriptor_pool_test.CreateDescriptorPoolTest.setUp">setUp</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="google.protobuf.internal.descriptor_pool_test.DefaultDescriptorPoolTest" href="#google.protobuf.internal.descriptor_pool_test.DefaultDescriptorPoolTest">DefaultDescriptorPoolTest</a></code></h4>
<ul class="">
<li><code><a title="google.protobuf.internal.descriptor_pool_test.DefaultDescriptorPoolTest.setUp" href="#google.protobuf.internal.descriptor_pool_test.DefaultDescriptorPoolTest.setUp">setUp</a></code></li>
<li><code><a title="google.protobuf.internal.descriptor_pool_test.DefaultDescriptorPoolTest.testFindMethods" href="#google.protobuf.internal.descriptor_pool_test.DefaultDescriptorPoolTest.testFindMethods">testFindMethods</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase" href="#google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase">DescriptorPoolTestBase</a></code></h4>
<ul class="">
<li><code><a title="google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testAddFileDescriptor" href="#google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testAddFileDescriptor">testAddFileDescriptor</a></code></li>
<li><code><a title="google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testAddSerializedFile" href="#google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testAddSerializedFile">testAddSerializedFile</a></code></li>
<li><code><a title="google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testComplexNesting" href="#google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testComplexNesting">testComplexNesting</a></code></li>
<li><code><a title="google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testConflictRegister" href="#google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testConflictRegister">testConflictRegister</a></code></li>
<li><code><a title="google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testDefaultValueForCustomMessages" href="#google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testDefaultValueForCustomMessages">testDefaultValueForCustomMessages</a></code></li>
<li><code><a title="google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testEnumDefaultValue" href="#google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testEnumDefaultValue">testEnumDefaultValue</a></code></li>
<li><code><a title="google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testExtensionsAreNotFields" href="#google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testExtensionsAreNotFields">testExtensionsAreNotFields</a></code></li>
<li><code><a title="google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testFindAllExtensions" href="#google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testFindAllExtensions">testFindAllExtensions</a></code></li>
<li><code><a title="google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testFindEnumTypeByName" href="#google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testFindEnumTypeByName">testFindEnumTypeByName</a></code></li>
<li><code><a title="google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testFindEnumTypeByNameFailure" href="#google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testFindEnumTypeByNameFailure">testFindEnumTypeByNameFailure</a></code></li>
<li><code><a title="google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testFindExtensionByName" href="#google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testFindExtensionByName">testFindExtensionByName</a></code></li>
<li><code><a title="google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testFindExtensionByNumber" href="#google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testFindExtensionByNumber">testFindExtensionByNumber</a></code></li>
<li><code><a title="google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testFindFieldByName" href="#google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testFindFieldByName">testFindFieldByName</a></code></li>
<li><code><a title="google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testFindFileByName" href="#google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testFindFileByName">testFindFileByName</a></code></li>
<li><code><a title="google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testFindFileByNameFailure" href="#google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testFindFileByNameFailure">testFindFileByNameFailure</a></code></li>
<li><code><a title="google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testFindFileContainingSymbol" href="#google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testFindFileContainingSymbol">testFindFileContainingSymbol</a></code></li>
<li><code><a title="google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testFindFileContainingSymbolFailure" href="#google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testFindFileContainingSymbolFailure">testFindFileContainingSymbolFailure</a></code></li>
<li><code><a title="google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testFindMessageTypeByName" href="#google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testFindMessageTypeByName">testFindMessageTypeByName</a></code></li>
<li><code><a title="google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testFindMessageTypeByNameFailure" href="#google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testFindMessageTypeByNameFailure">testFindMessageTypeByNameFailure</a></code></li>
<li><code><a title="google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testFindOneofByName" href="#google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testFindOneofByName">testFindOneofByName</a></code></li>
<li><code><a title="google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testFindService" href="#google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testFindService">testFindService</a></code></li>
<li><code><a title="google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testFindTypeErrors" href="#google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testFindTypeErrors">testFindTypeErrors</a></code></li>
<li><code><a title="google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testUserDefinedDB" href="#google.protobuf.internal.descriptor_pool_test.DescriptorPoolTestBase.testUserDefinedDB">testUserDefinedDB</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="google.protobuf.internal.descriptor_pool_test.EnumField" href="#google.protobuf.internal.descriptor_pool_test.EnumField">EnumField</a></code></h4>
<ul class="">
<li><code><a title="google.protobuf.internal.descriptor_pool_test.EnumField.CheckField" href="#google.protobuf.internal.descriptor_pool_test.EnumField.CheckField">CheckField</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="google.protobuf.internal.descriptor_pool_test.EnumType" href="#google.protobuf.internal.descriptor_pool_test.EnumType">EnumType</a></code></h4>
<ul class="">
<li><code><a title="google.protobuf.internal.descriptor_pool_test.EnumType.CheckType" href="#google.protobuf.internal.descriptor_pool_test.EnumType.CheckType">CheckType</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="google.protobuf.internal.descriptor_pool_test.ExtensionField" href="#google.protobuf.internal.descriptor_pool_test.ExtensionField">ExtensionField</a></code></h4>
<ul class="">
<li><code><a title="google.protobuf.internal.descriptor_pool_test.ExtensionField.CheckField" href="#google.protobuf.internal.descriptor_pool_test.ExtensionField.CheckField">CheckField</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="google.protobuf.internal.descriptor_pool_test.MessageField" href="#google.protobuf.internal.descriptor_pool_test.MessageField">MessageField</a></code></h4>
<ul class="">
<li><code><a title="google.protobuf.internal.descriptor_pool_test.MessageField.CheckField" href="#google.protobuf.internal.descriptor_pool_test.MessageField.CheckField">CheckField</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="google.protobuf.internal.descriptor_pool_test.MessageType" href="#google.protobuf.internal.descriptor_pool_test.MessageType">MessageType</a></code></h4>
<ul class="">
<li><code><a title="google.protobuf.internal.descriptor_pool_test.MessageType.CheckType" href="#google.protobuf.internal.descriptor_pool_test.MessageType.CheckType">CheckType</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="google.protobuf.internal.descriptor_pool_test.ProtoFile" href="#google.protobuf.internal.descriptor_pool_test.ProtoFile">ProtoFile</a></code></h4>
<ul class="">
<li><code><a title="google.protobuf.internal.descriptor_pool_test.ProtoFile.CheckFile" href="#google.protobuf.internal.descriptor_pool_test.ProtoFile.CheckFile">CheckFile</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="google.protobuf.internal.descriptor_pool_test.SecondaryDescriptorFromDescriptorDB" href="#google.protobuf.internal.descriptor_pool_test.SecondaryDescriptorFromDescriptorDB">SecondaryDescriptorFromDescriptorDB</a></code></h4>
<ul class="">
<li><code><a title="google.protobuf.internal.descriptor_pool_test.SecondaryDescriptorFromDescriptorDB.setUp" href="#google.protobuf.internal.descriptor_pool_test.SecondaryDescriptorFromDescriptorDB.setUp">setUp</a></code></li>
<li><code><a title="google.protobuf.internal.descriptor_pool_test.SecondaryDescriptorFromDescriptorDB.testErrorCollector" href="#google.protobuf.internal.descriptor_pool_test.SecondaryDescriptorFromDescriptorDB.testErrorCollector">testErrorCollector</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="google.protobuf.internal.descriptor_pool_test.StringField" href="#google.protobuf.internal.descriptor_pool_test.StringField">StringField</a></code></h4>
<ul class="">
<li><code><a title="google.protobuf.internal.descriptor_pool_test.StringField.CheckField" href="#google.protobuf.internal.descriptor_pool_test.StringField.CheckField">CheckField</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.7.4</a>.</p>
</footer>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad()</script>
</body>
</html>