
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Architecture Â· OpenStorage API</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-codetabs/codetabs.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-toggle-chapters/toggle.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-prism/prism.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-page-toc/page-toc.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="installation.html" />
    
    
    <link rel="prev" href="./" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        <li class="header">OpenStorage SDK</li>
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                        <b>1.1.</b>
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.2" data-path="arch.html">
            
                <a href="arch.html">
            
                    
                        <b>1.2.</b>
                    
                    Architecture
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="installation.html">
            
                <a href="installation.html">
            
                    
                        <b>1.3.</b>
                    
                    Installation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="tutorial.html">
            
                <a href="tutorial.html">
            
                    
                        <b>1.4.</b>
                    
                    Tutorial
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="tutorial-golang.html">
            
                <a href="tutorial-golang.html">
            
                    
                        <b>1.4.1.</b>
                    
                    Golang
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="tutorial-python.html">
            
                <a href="tutorial-python.html">
            
                    
                        <b>1.4.2.</b>
                    
                    Python
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="reference.html">
            
                <a href="reference.html">
            
                    
                        <b>1.5.</b>
                    
                    API Reference
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="release-sdk-0.9.generated-api.html">
            
                <a href="release-sdk-0.9.generated-api.html">
            
                    
                        <b>1.5.1.</b>
                    
                    v0.9.x
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1.1" data-path="release-sdk-0.9.changelog.html">
            
                <a href="release-sdk-0.9.changelog.html">
            
                    
                        <b>1.5.1.1.</b>
                    
                    Changelog
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="release-4.0.generated-api.html">
            
                <a href="release-4.0.generated-api.html">
            
                    
                        <b>1.5.2.</b>
                    
                    v0.22.x
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.2.1" data-path="release-4.0.changelog.html">
            
                <a href="release-4.0.changelog.html">
            
                    
                        <b>1.5.2.1.</b>
                    
                    Changelog
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="master.generated-api.html">
            
                <a href="master.generated-api.html">
            
                    
                        <b>1.5.3.</b>
                    
                    Nightly
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.3.1" data-path="master.changelog.html">
            
                <a href="master.changelog.html">
            
                    
                        <b>1.5.3.1.</b>
                    
                    Changelog
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="." >Architecture</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="architecture">Architecture</h1>
<p><img src="images/arch.png" alt="arch.png"></p>
<h2 id="overview">Overview</h2>
<p>The software development kit for OpenStorage is based on <a href="https://grpc.io/" target="_blank">gRPC</a>,
allowing clients to be automatically generated in multiple languages. The SDK
also provides a gRPC REST Gateway which automatically changes REST requests
to gRPC.</p>
<p>Different OpenStorage drivers may run the OpenStorage gRPC and REST servers on
different ports. Please, refer to your deployed driver documentation for
instructions on how to setup a connection to the gRPC server.</p>
<p>OpenStorage API calls are ment to be idempotent to ensure consistency across calls, unless
otherwise specified.</p>
<h2 id="protocol-buffers-grpc-source-file">Protocol Buffers gRPC Source File</h2>
<p>The gRPC bindings are created from <a href="https://github.com/libopenstorage/openstorage/blob/master/api/api.proto" target="_blank"><code>api/api.proto</code></a> file
available in the OpenStorage github repo.</p>
<h2 id="rest-grpc-gateway">REST gRPC Gateway</h2>
<p>REST clients can benefit from the SDK server&apos;s <a href="https://github.com/grpc-ecosystem/grpc-gateway" target="_blank">gRPC REST Gateway</a>
which is able to translate REST calls to gRPC requests.</p>
<p><a href="https://swagger.io/" target="_blank">Swagger</a> is also provided by going to the REST gRPC Gateway
and passing the path <code>/swagger-ui</code>.</p>
<h2 id="security">Security</h2>
<p>Starting at <em>v0.38.0</em>, the OpenStorage SDK supports security based on the
following set of technologies:</p>
<ul>
<li><strong>TLS</strong>: The SDK now supports TLS to secure client server communications.</li>
<li><strong>Authentication</strong>: Support for authentication based on JWT and OpenID Connect(OIDC)</li>
<li><strong>Authorization</strong>: Support for role based access control (RBAC) access to
OpenStorage SDK API calls</li>
<li><strong>Ownership</strong>: Support for resource access control based on owner, groups,
and collaborators.</li>
</ul>
<h3 id="authentication">Authentication</h3>
<p>OpenStorage SDK server authenticates and authorizes access using the token
provided by the client. The SDK server expects the token to be passed in
the metadata of the gRPC context. Here is an example of how to pass the token
in gRPC:</p>
<p><div class="codetabs"><div class="codetabs-header"><div class="tab active" data-codetab="0">Go</div><div class="tab" data-codetab="1">Python</div></div><div class="codetabs-body"><div class="tab active" data-codetab="0"><pre class="language-"><code class="lang-go"><span class="token keyword">import</span> <span class="token string">&quot;google.golang.org/grpc/metadata&quot;</span>

md <span class="token operator">:=</span> metadata<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span>
        <span class="token string">&quot;authorization&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;bearer&quot;</span> <span class="token operator">+</span> token<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
ctx <span class="token operator">=</span> metadata<span class="token punctuation">.</span><span class="token function">NewOutgoingContext</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span><span class="token function">Background</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> md<span class="token punctuation">)</span></code></pre></div><div class="tab" data-codetab="1"><pre class="language-"><code class="lang-py">md <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
md<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">&quot;authorization&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;bearer &quot;</span><span class="token operator">+</span>token<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># Now add metadata to the call</span>
clusters <span class="token operator">=</span> api_pb2_grpc<span class="token punctuation">.</span>OpenStorageClusterStub<span class="token punctuation">(</span>channel<span class="token punctuation">)</span>
response <span class="token operator">=</span> clusters<span class="token punctuation">.</span>InspectCurrent<span class="token punctuation">(</span>api_pb2<span class="token punctuation">.</span>SdkClusterInspectCurrentRequest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> metadata<span class="token operator">=</span>md<span class="token punctuation">)</span></code></pre></div></div></div></p>
<p>If your language supports gRPC interceptors, you may be able to simply your
client code by making the interceptor add the authorization token on every
call automatically.</p>
<p>To pass the token using the REST Gateway, you can use the <a href="https://tools.ietf.org/html/rfc6750" target="_blank">standard header</a>:</p>
<pre class="language-"><code>&quot;authorization&quot;: &quot;bearer token...&quot;
</code></pre><h2 id="error-handling">Error Handling</h2>
<p>All API calls use the <a href="https://github.com/grpc/grpc/blob/master/src/proto/grpc/status/status.proto" target="_blank">standard gRPC status</a>.</p>
<h2 id="openstorage-sdk-implementations">OpenStorage SDK Implementations</h2>
<p>In this document, examples will refer to both the <a href="tutorial.html">OpenStorage SDK Mock</a>
and Portworx OpenStorage drivers.</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="./" class="navigation navigation-prev " aria-label="Previous page: Introduction">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="installation.html" class="navigation navigation-next " aria-label="Next page: Installation">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Architecture","level":"1.2","depth":1,"next":{"title":"Installation","level":"1.3","depth":1,"path":"installation.md","ref":"installation.md","articles":[]},"previous":{"title":"Introduction","level":"1.1","depth":1,"path":"README.md","ref":"README.md","articles":[]},"dir":"ltr"},"config":{"plugins":["codetabs","toggle-chapters","toggle-headers","edit-link","prism","github","page-toc","-highlight","-sharing"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"prism":{},"github":{"url":"https://github.com/libopenstorage/openstorage/"},"search":{},"page-toc":{"position":"top","selector":".markdown-section h1, .markdown-section h2","showByDefault":false},"codetabs":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"toggle-headers":{},"fontsettings":{"theme":"white","family":"sans","size":2},"edit-link":{"label":"Edit this page","base":"https://github.com/libopenstorage/libopenstorage.github.io/tree/master/docs"},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":true},"toggle-chapters":{}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"OpenStorage API","gitbook":">=3.2.1"},"file":{"path":"arch.md","mtime":"2019-02-11T07:00:47.869Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2019-02-11T07:12:07.475Z"},"basePath":".","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="gitbook/gitbook.js"></script>
    <script src="gitbook/theme.js"></script>
    
        
        <script src="gitbook/gitbook-plugin-codetabs/codetabs.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-toggle-chapters/toggle.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-toggle-headers/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-edit-link/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-github/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-page-toc/anchor-3.1.1.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-page-toc/page-toc.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

